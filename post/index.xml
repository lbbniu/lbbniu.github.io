<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æ–‡ç« åˆ—è¡¨ on lbbniu</title><link>/post/</link><description>Recent content in æ–‡ç« åˆ—è¡¨ on lbbniu</description><generator>Hugo -- gohugo.io</generator><language>zh</language><managingEditor>lbbniu@gmail.com (lbbniu)</managingEditor><webMaster>lbbniu@gmail.com (lbbniu)</webMaster><copyright>&amp;copy; 2021 &lt;a href="https://blog.lbbniu.com/">lbbniu&lt;/a></copyright><lastBuildDate>Sat, 20 Nov 2021 17:18:16 +0800</lastBuildDate><atom:link href="/post/index.xml" rel="self" type="application/rss+xml"/><item><title>æ¨¡æ¿-æ ‡é¢˜</title><link>/2024/01/15/uri-addr/</link><pubDate>Mon, 15 Jan 2024 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/15/uri-addr/</guid><description>å…³æ³¨å…¬ä¼—å·è·å¾—æ›´å¤šç²¾å½©æ–‡ç« </description></item><item><title>å†™ç»™Goå¼€å‘è€…çš„Tarsæ•™ç¨‹-è¶…æ—¶æ§åˆ¶</title><link>/2024/01/10/tarsgo-context/</link><pubDate>Wed, 10 Jan 2024 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/10/tarsgo-context/</guid><description>æœ¬ç¯‡ä¸ºã€å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹ã€‘ç³»åˆ—ç¬¬å…­ç¯‡
ç¬¬ä¸€ç¯‡ï¼šTarsåè®®åŸºç¡€ ç¬¬äºŒç¯‡ï¼šé€šä¿¡æ¨¡å¼ ç¬¬ä¸‰ç¯‡ï¼šæ‹¦æˆªå™¨ ç¬¬å››ç¯‡ï¼šé”™è¯¯å¤„ç† ç¬¬äº”ç¯‡ï¼šcontext/status ç¬¬å…­ç¯‡ï¼šè¶…æ—¶æ§åˆ¶
æœ¬ç³»åˆ—å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘è·å–å®æ—¶é€šçŸ¥
å¯¼è¨€
ä¸€ä¸ªåˆç†çš„è¶…æ—¶æ—¶é—´æ˜¯éå¸¸å¿…è¦çš„ï¼Œå®ƒèƒ½æé«˜ç”¨æˆ·ä½“éªŒï¼Œæé«˜æœåŠ¡å™¨çš„æ•´ä½“æ€§èƒ½ï¼Œæ˜¯æœåŠ¡æ²»ç†çš„å¸¸è§æ‰‹æ®µä¹‹ä¸€
ä¸ºä»€ä¹ˆè¦è®¾ç½®è¶…æ—¶ ç”¨æˆ·ä½“éªŒï¼šå¾ˆå¤šRPCéƒ½æ˜¯ç”±ç”¨æˆ·ä¾§å‘èµ·ï¼Œå¦‚æœè¯·æ±‚ä¸è®¾ç½®è¶…æ—¶æ—¶é—´æˆ–è€…è¶…æ—¶æ—¶é—´ä¸åˆç†ï¼Œä¼šå¯¼è‡´ç”¨æˆ·ä¸€ç›´å¤„äºç™½å±æˆ–è€…è¯·æ±‚ä¸­çš„çŠ¶æ€ï¼Œå½±å“ç”¨æˆ·çš„ä½“éªŒ
èµ„æºåˆ©ç”¨ï¼šä¸€ä¸ªRPCä¼šå ç”¨ä¸¤ç«¯ï¼ˆæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ï¼‰ç«¯å£ã€cpuã€å†…å­˜ç­‰ä¸€ç³»åˆ—çš„èµ„æºï¼Œä¸åˆç†çš„è¶…æ—¶æ—¶é—´ä¼šå¯¼è‡´RPCå ç”¨çš„èµ„æºè¿Ÿè¿Ÿä¸èƒ½è¢«é‡Šæ”¾ï¼Œå› è€Œå½±å“æœåŠ¡å™¨ç¨³å®šæ€§
ç»¼ä¸Šï¼Œä¸€ä¸ªåˆç†çš„è¶…æ—¶æ—¶é—´æ˜¯éå¸¸å¿…è¦çš„ã€‚åœ¨ä¸€äº›è¦æ±‚æ›´é«˜çš„æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é’ˆå¯¹DNSè§£æã€è¿æ¥å»ºç«‹ï¼Œè¯»ã€å†™ç­‰è®¾ç½®æ›´ç²¾ç»†çš„è¶…æ—¶æ—¶é—´ã€‚é™¤äº†è®¾ç½®é™æ€çš„è¶…æ—¶æ—¶é—´ï¼Œæ ¹æ®å½“å‰ç³»ç»ŸçŠ¶æ€ã€æœåŠ¡é“¾è·¯ç­‰è®¾ç½®è‡ªé€‚åº”çš„åŠ¨æ€è¶…æ—¶æ—¶é—´ä¹Ÿæ˜¯æœåŠ¡æ²»ç†ä¸­ä¸€ä¸ªå¸¸è§çš„æ–¹æ¡ˆã€‚
å®¢æˆ·ç«¯çš„è¶…æ—¶ è¿æ¥è¶…æ—¶ è¿˜è®°å¾—æˆ‘ä»¬æ€ä¹ˆåœ¨å®¢æˆ·ç«¯åˆ›å»ºçš„ä¹ˆï¼Ÿ
comm := tars.GetCommunicator() client := new(order.OrderManagement) obj := &amp;quot;Test.OrderServer.OrderObj@tcp -h 127.0.0.1 -p 8080 -t 60000&amp;quot; comm.StringToProxy(obj, client) // order, err := client.GetOrderWithContext(ctx, &amp;quot;1&amp;quot;) // if err != nil { // panic(err) // } å¦‚æœç›®æ ‡åœ°å€tcp -h 127.0.0.1 -p 8080 -t 60000æ— æ³•å»ºç«‹è¿æ¥ï¼Œcomm.StringToProxyä¼šå‡ºç°é”™è¯¯æˆ–panicä¹ˆï¼Ÿè¿™é‡Œç›´æ¥æ”¾ç»“è®ºï¼šä¸ä¼šçš„ï¼ŒTarsGoåªæœ‰åœ¨å‘ç”ŸRPCè°ƒç”¨æ—¶æ‰ä¼šåˆ›å»ºè¿æ¥ï¼Œå¹¶ä¸ä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œå¦‚æœRPCè°ƒç”¨æ—¶è¿æ¥æ²¡æœ‰åˆ›å»ºæˆåŠŸä¼šåœ¨RPCè°ƒç”¨ä¸­æŠ¥é”™ã€‚
å¦‚æœæˆ‘ä»¬æƒ³æ§åˆ¶è¿æ¥åˆ›å»ºæ—¶çš„è¶…æ—¶æ—¶é—´è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ
å¯ä»¥ä¿®æ”¹TarsæœåŠ¡çš„å¯åŠ¨é…ç½®æ–‡ä»¶å¯¹åº”çš„é…ç½®é¡¹æ¥å®Œæˆï¼Œç›®å‰ä¹Ÿåªèƒ½é€šè¿‡é…ç½®æ–‡ä»¶è¿›é…ç½®ã€‚é»˜è®¤é“¾æ¥è¶…æ—¶æ—¶é—´ä¸º3000æ¯«ç§’ï¼Œå¦‚ä¸‹æ‰€ç¤ºé…ç½®å€¼ä¸ºæ¯«ç§’æ—¶é—´æˆ³ã€‚
&amp;lt;tars&amp;gt; &amp;lt;application&amp;gt; &amp;lt;client&amp;gt; # é»˜è®¤å€¼ä¸º3000æ¯«ç§’ clientdialtimeout=3000 &amp;lt;/client&amp;gt; &amp;lt;/application&amp;gt; &amp;lt;/tars&amp;gt; æœåŠ¡è°ƒç”¨çš„è¶…æ—¶ å’Œä¸Šé¢è¿æ¥è¶…æ—¶çš„é…ç½®ç±»ä¼¼ã€‚ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š
&amp;lt;tars&amp;gt; &amp;lt;application&amp;gt; &amp;lt;client&amp;gt; # é»˜è®¤å€¼ä¸º3000æ¯«ç§’ async-invoke-timeout=3000 &amp;lt;/client&amp;gt; &amp;lt;/application&amp;gt; &amp;lt;/tars&amp;gt; åŒæ—¶XXXWithContextæœåŠ¡è°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°å‡æ˜¯context.</description></item><item><title>å†™ç»™Goå¼€å‘è€…çš„Tarsæ•™ç¨‹-context/status</title><link>/2024/01/09/tarsgo-context/</link><pubDate>Tue, 09 Jan 2024 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/09/tarsgo-context/</guid><description>æœ¬ç¯‡ä¸ºã€å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹ã€‘ç³»åˆ—ç¬¬äº”ç¯‡
ç¬¬ä¸€ç¯‡ï¼šTarsåè®®åŸºç¡€ ç¬¬äºŒç¯‡ï¼šé€šä¿¡æ¨¡å¼ ç¬¬ä¸‰ç¯‡ï¼šæ‹¦æˆªå™¨ ç¬¬å››ç¯‡ï¼šé”™è¯¯å¤„ç† ç¬¬äº”ç¯‡ï¼šcontext/status
æœ¬ç³»åˆ—å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘è·å–å®æ—¶é€šçŸ¥
å¯¼è¯­
å’Œåœ¨æ™®é€šHTTPè¯·æ±‚ä¸­ä¸€æ ·ï¼ŒTarsGoæä¾›äº†åœ¨æ¯ä¸€æ¬¡RPCä¸­æºå¸¦ä¸Šä¸‹æ–‡çš„ç»“æ„ï¼šcontextå’Œstatusã€‚åœ¨Goè¯­è¨€ä¸­ï¼Œå®ƒä¸context.Contextç´§å¯†ç»“åˆï¼Œå¸®åŠ©æˆ‘ä»¬å®ç°æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´äº’ç›¸ä¼ é€’ä¿¡æ¯ã€‚å…¶ä¸­statusä¸»è¦ç”¨äºæ¡†æ¶åº•å±‚ä¼ é€’ä¸€äº›æ¡†æ¶ç‰¹æ€§ç›¸å…³çš„æ•°æ®ã€‚
ä»€ä¹ˆæ˜¯ contextï¼Ÿ TarsGo çš„ contextå’Œstatusçš„ç®€å•ç†è§£ï¼Œå°±æ˜¯ HTTP Header ä¸­çš„ key-value å¯¹
contextå’Œstatus éƒ½æ˜¯ä»¥ key-value çš„å½¢å¼å­˜å‚¨æ•°æ®çš„ï¼Œå…¶ä¸­ key å’Œ valueéƒ½æ˜¯ string ç±»å‹ã€‚ contextå’Œstatus ä½¿å¾— client å’Œ server èƒ½å¤Ÿä¸ºå¯¹æ–¹æä¾›å…³äºæœ¬æ¬¡è°ƒç”¨çš„ä¸€äº›ä¿¡æ¯ï¼Œå°±åƒä¸€æ¬¡HTTPè¯·æ±‚çš„Request Headerå’ŒResponse Headerä¸€æ · HTTP Header çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œé‚£ä¹ˆ contextå’Œstatus çš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä¸€æ¬¡ RPC è°ƒç”¨ contextå’Œstatus åˆ›å»º ğŸŒ² ç›´æ¥ä½¿ç”¨makeå³å¯ï¼š context := make(map[string]string) status := make(map[string]string) ğŸŒ² ç›´æ¥ä½¿ç”¨mapåˆå§‹åŒ–æ–¹å¼ï¼š context := map[string]string{&amp;quot;key1&amp;quot;:&amp;quot;value1&amp;quot;,&amp;quot;key2&amp;quot;:&amp;quot;value2&amp;quot;} status := map[string]string{&amp;quot;key1&amp;quot;:&amp;quot;value1&amp;quot;,&amp;quot;key2&amp;quot;:&amp;quot;value2&amp;quot;} contextå’Œstatus å‘é€å’Œæ¥å— è®©æˆ‘ä»¬å†æ¬¡å›é¡¾ä¸‹tarsæ–‡ä»¶å’Œç”Ÿæˆå‡ºæ¥çš„clientä¸serverç«¯çš„æ¥å£
module order { struct Order { 1 require string id; 2 optional vector&amp;lt;string&amp;gt; items; 3 optional string description; 4 require float price; 5 optional string destination; }; interface OrderManagement { Order getOrder(string orderId); }; }; type OrderManagement struct { servant m.</description></item><item><title>å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹-é”™è¯¯å¤„ç†</title><link>/2024/01/08/tarsgo-errors/</link><pubDate>Mon, 08 Jan 2024 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/08/tarsgo-errors/</guid><description>æœ¬ç¯‡ä¸ºã€å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹ã€‘ç³»åˆ—ç¬¬å››ç¯‡
ç¬¬ä¸€ç¯‡ï¼šTarsåè®®åŸºç¡€ ç¬¬äºŒç¯‡ï¼šé€šä¿¡æ¨¡å¼ ç¬¬ä¸‰ç¯‡ï¼šæ‹¦æˆªå™¨ ç¬¬å››ç¯‡ï¼šé”™è¯¯å¤„ç†
æœ¬ç³»åˆ—å°†æŒç»­æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘è·å–å®æ—¶é€šçŸ¥
åŸºæœ¬é”™è¯¯å¤„ç† é¦–å…ˆå›é¡¾ä¸‹tarsæ–‡ä»¶å’Œç”Ÿæˆå‡ºæ¥çš„clientä¸serverç«¯çš„æ¥å£
module order { struct Order { 1 require string id; 2 optional vector&amp;lt;string&amp;gt; items; 3 optional string description; 4 require float price; 5 optional string destination; }; interface OrderManagement { Order getOrder(string orderId); }; }; type OrderManagement struct { servant m.Servant } func (obj *OrderManagement) GetOrder(orderId string, opts ...map[string]string) (Order, error) { return obj.GetOrderWithContext(context.Background(), orderId, opts...) } func (obj *OrderManagement) GetOrderWithContext(tarsCtx context.Context, orderId string, opts ...map[string]string) (ret Order, err error) { // .</description></item><item><title>å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹-æ‹¦æˆªå™¨</title><link>/2024/01/07/tarsgo-middleware/</link><pubDate>Sun, 07 Jan 2024 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/07/tarsgo-middleware/</guid><description>æœ¬ç¯‡ä¸ºã€å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹ã€‘ç³»åˆ—ç¬¬ä¸‰ç¯‡
ç¬¬ä¸€ç¯‡ï¼šTarsåè®®åŸºç¡€ ç¬¬äºŒç¯‡ï¼šé€šä¿¡æ¨¡å¼ ç¬¬ä¸‰ç¯‡ï¼šæ‹¦æˆªå™¨
TarsGoçš„æ‹¦æˆªå™¨å’Œå…¶ä»–æ¡†æ¶çš„æ‹¦æˆªå™¨ï¼ˆä¹Ÿç§°middlewareï¼‰ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚åˆ©ç”¨æ‹¦æˆªå™¨æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¾µå…¥ä¸šåŠ¡é€»è¾‘çš„å‰æä¸‹ä¿®æ”¹æˆ–è€…è®°å½•æœåŠ¡ç«¯æˆ–å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸å“åº”ï¼Œåˆ©ç”¨æ‹¦æˆªå™¨æˆ‘ä»¬å¯ä»¥å®ç°è¯¸å¦‚æ—¥å¿—è®°å½•ã€æƒé™è®¤è¯ã€é™æµã€é“¾è·¯è¿½è¸ªç­‰è¯¸å¤šåŠŸèƒ½ã€‚æ‹¦æˆªå™¨å¯ä»¥åˆ†åˆ«åº”ç”¨åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œæ‰€ä»¥TarsGoæ€»å…±ä¸ºæˆ‘ä»¬æä¾›äº†å¤šç§æ‹¦æˆªå™¨ï¼Œä¸‹é¢æˆ‘ä»¬è¿›è¡Œä¸€ä¸€ä»‹ç»ã€‚
æœåŠ¡ç«¯æ‹¦æˆªå™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰ å¤„ç†å‰åæ‹¦æˆªå™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰ æ‹¦æˆªå™¨å®šä¹‰å¦‚ä¸‹ï¼š
// Dispatch server side Dispatch type Dispatch func(context.Context, interface{}, *requestf.RequestPacket, *requestf.ResponsePacket, bool) error // ServerFilter is used for add Filter for server dispatcher ,for implementing plugins like opentracing. type ServerFilter func(ctx context.Context, d Dispatch, f interface{}, req *requestf.RequestPacket, resp *requestf.ResponsePacket, withContext bool) (err error) æ³¨å†ŒæœåŠ¡ç«¯æ‹¦æˆªå™¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š
func RegisterServerFilter(f ServerFilter) // æ³¨å†ŒæœåŠ¡ç«¯æ‹¦æˆªå™¨ï¼Œåªèƒ½æ³¨å†Œä¸€ä¸ª func RegisterPreServerFilter(f ServerFilter) // æ³¨å†ŒæœåŠ¡ç«¯å¤„ç†å‰æ‹¦æˆªå™¨ï¼Œå¯å¤šä¸ª func RegisterPostServerFilter(f ServerFilter) // æ³¨å†ŒæœåŠ¡ç«¯å¤„ç†åæ‹¦æˆªå™¨ï¼Œå¯å¤šä¸ª ä¸æ¨èä¸Šé¢ä¸‰ç§æ³¨å†Œæ–¹æ³•æ¥æ³¨å†Œæ‹¦æˆªä»¶ï¼Œå°†åœ¨1.5ç‰ˆæœ¬åå½»åº•åºŸå¼ƒç§»é™¤ï¼Œæ¨èä½¿ç”¨ä¸‹é¢ä»‹ç»çš„ä¸­é—´ä»¶å®ç°å¯¹åº”çš„é€»è¾‘ã€‚
ç¤ºä¾‹ï¼š
// æ³¨å†ŒæœåŠ¡ç«¯è¿‡æ»¤å™¨ tars.RegisterServerFilter(func(ctx context.Context, d tars.</description></item><item><title>ä¸€ç¯‡æ–‡ç« ç²¾é€šphpå¤šç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼šphpbrew</title><link>/2024/01/04/phpbrew/</link><pubDate>Thu, 04 Jan 2024 22:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2024/01/04/phpbrew/</guid><description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯lbbniuã€‚
ä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä»¥ä¸‹ Uber å¼€æºçš„é™æ€åˆ†æå·¥å…· NilAwayï¼Œä¸‹é¢å¼€é²ã€‚
æœ€è¿‘ Uber å¼€å‘å’Œå¼€æºäº†ä¸€ä¸ªæŒºä¸é”™çš„é™æ€åˆ†æå·¥å…· NilAwayï¼š
NilAwayæ˜¯ä¸€ä¸ªé™æ€åˆ†æå·¥å…·ï¼Œæ—¨åœ¨é€šè¿‡åœ¨ç¼–è¯‘æ—¶è€Œä¸æ˜¯è¿è¡Œæ—¶æ•è·nil panicæ¥å¸®åŠ©å¼€å‘äººå‘˜é¿å…åœ¨ç”Ÿäº§ä¸­å‡ºç°è¿™ç§æƒ…å†µã€‚NilAwayç±»ä¼¼äºæ ‡å‡†çš„nilnessåˆ†æå™¨ï¼Œä½†å®ƒé‡‡ç”¨æ›´å¤æ‚å’Œå¼ºå¤§çš„é™æ€åˆ†ææŠ€æœ¯æ¥è·Ÿè¸ªåŒ…å†…å’Œè·¨åŒ…çš„nilæµï¼Œå¹¶æŠ¥å‘Šé”™è¯¯ï¼Œä¸ºç”¨æˆ·æä¾›æ›´è½»æ¾çš„è°ƒè¯•nilnessæµç¨‹ã€‚
NilAwayå…·æœ‰ä¸‰ä¸ªå…³é”®ç‰¹æ€§ï¼Œä½¿å…¶è„±é¢–è€Œå‡ºï¼š
å®Œå…¨è‡ªåŠ¨åŒ–ï¼šNilAwayé…å¤‡æœ‰æ¨ç†å¼•æ“ï¼Œå› æ­¤é™¤äº†æ ‡å‡†çš„Goä»£ç ä¹‹å¤–ï¼Œå®ƒä¸éœ€è¦ä»å¼€å‘äººå‘˜é‚£é‡Œè·å–ä»»ä½•å…¶ä»–ä¿¡æ¯ï¼ˆä¾‹å¦‚æ³¨é‡Šï¼‰ã€‚ é€Ÿåº¦å¿«ï¼šæˆ‘ä»¬è®¾è®¡NilAwayä¸ºå¿«é€Ÿä¸”å¯æ‰©å±•ï¼Œé€‚ç”¨äºå¤§å‹ä»£ç åº“ã€‚åœ¨æˆ‘ä»¬çš„æµ‹é‡ä¸­ï¼Œå¯ç”¨NilAwayæ—¶æ„å»ºæ—¶é—´å¼€é”€ä¸åˆ°5%ã€‚æˆ‘ä»¬è¿˜åœ¨ä¸æ–­åº”ç”¨ä¼˜åŒ–æ¥è¿›ä¸€æ­¥å‡å°‘å…¶å ç”¨ç©ºé—´ã€‚ å®ç”¨æ€§ï¼šå®ƒä¸èƒ½é˜»æ­¢ä»£ç ä¸­æ‰€æœ‰å¯èƒ½çš„nil panicï¼Œä½†å®ƒå¯ä»¥æ•è·æˆ‘ä»¬åœ¨ç”Ÿäº§ä¸­è§‚å¯Ÿåˆ°çš„å¤§å¤šæ•°æ½œåœ¨nil panicï¼Œä½¿NilAwayåœ¨å®ç”¨æ€§å’Œæ„å»ºæ—¶é—´å¼€é”€ä¹‹é—´ä¿æŒè‰¯å¥½å¹³è¡¡ã€‚ å®‰è£… NilAwayæ˜¯ä½¿ç”¨æ ‡å‡†çš„go/analysisæ¡†æ¶å®ç°çš„ï¼Œå› æ­¤æ˜“äºä¸ç°æœ‰çš„åˆ†æé©±åŠ¨ç¨‹åºé›†æˆï¼ˆä¾‹å¦‚golangci-lintã€nogoæˆ–ä½œä¸ºç‹¬ç«‹æ£€æŸ¥å™¨è¿è¡Œï¼‰ã€‚ä¸‹é¢æ˜¯å°†NilAwayä½œä¸ºç‹¬ç«‹æ£€æŸ¥å™¨è¿è¡Œçš„è¯´æ˜ã€‚æ›´å¤šé›†æˆæ”¯æŒå°†å¾ˆå¿«æ·»åŠ ã€‚
ç‹¬ç«‹æ£€æŸ¥å™¨ é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä»æºä»£ç å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶ï¼š
go install go.uber.org/nilaway/cmd/nilaway@latest ç„¶åï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œlinterï¼š
nilaway ./... ä»£ç ç¤ºä¾‹ æ¡ˆä¾‹ä¸€ è®©æˆ‘ä»¬çœ‹ä¸€äº›ç¤ºä¾‹ï¼Œäº†è§£NilAwayå¦‚ä½•å¸®åŠ©é˜²æ­¢nil panicã€‚
// Example 1: var p *P if someCondition { p = &amp;amp;P{} } print(p.f) // nilness reports NO error here, but NilAway does. åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå±€éƒ¨å˜é‡pä»…åœ¨someConditionä¸ºtrueæ—¶åˆå§‹åŒ–ã€‚åœ¨å­—æ®µè®¿é—®p.fæ—¶ï¼Œå¦‚æœsomeConditionä¸ºfalseï¼Œåˆ™å¯èƒ½å‘ç”Ÿpanicã€‚NilAwayèƒ½å¤Ÿæ•è·è¿™ä¸ªæ½œåœ¨çš„nilå¯¼è‡´çš„panicå¹¶æŠ¥å‘Šä»¥ä¸‹é”™è¯¯ï¼š
go.uber.org/example.go:12:9: error: Potential nil panic detected. Observed nil flow from source to dereference point: -&amp;gt; go.uber.org/example.go:12:9: unassigned variable `p` accessed field `f` å¦‚æœæˆ‘ä»¬ä½¿ç”¨nilæ£€æŸ¥ï¼ˆif p !</description></item><item><title>ç”¨GolangåŠ©åŠ›è¡¨å¦¹è½»æ¾å®ç°è‡ªåŠ¨åŒ–åŠå…¬ï¼ï¼ˆå®Œæ•´ä»£ç é™„åï¼‰</title><link>/2023/12/10/goalng-execl/</link><pubDate>Sun, 10 Dec 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/12/10/goalng-execl/</guid><description>Helloï¼Œå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯lbbniu~
ä»Šå¤©æœ‰ä¸€ä¸ªæœ‰è¶£çš„ç¼–ç¨‹éœ€æ±‚è¦åˆ†äº«ï¼Œè¿™æ¬¡çš„çµæ„Ÿæ¥æºäºæˆ‘å¯çˆ±çš„è¡¨å¦¹ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨Golangå¯¹Excelæ–‡ä»¶è¿›è¡Œæ‰¹é‡å¤„ç†ï¼Œè¾¾åˆ°é«˜æ•ˆè‡ªåŠ¨åŒ–åŠå…¬çš„ç›®çš„ã€‚
ä¸€ã€å…·ä½“éœ€æ±‚ æ‰‹ä¸Šæœ‰ä¸€ç³»åˆ—Nä¸ªè¡¨æ ¼ï¼Œæ¯ä¸ªè¡¨æ ¼éƒ½æœ‰ç›¸åŒçš„ç»“æ„ï¼Œçœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š
ä»»åŠ¡æ˜¯å°†æ‰€æœ‰è¡¨ä¸­çš„æ•°æ®æ±‡æ€»ï¼ŒæŒ‰ç…§æ¯ä¸ªäººçš„å¾—åˆ†å’Œç§¯åˆ†è¿›è¡Œåˆè®¡ï¼Œç„¶åæŒ‰æ€»ç§¯åˆ†æ’åã€‚åœ¨æ€»ç§¯åˆ†ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œåæ¬¡ä¹Ÿç›¸åŒä½†ä¸æ˜¯è¿ç»­çš„æ’åºã€‚å¦‚æœæ€»ç§¯åˆ†å’Œåæ¬¡éƒ½ç›¸åŒï¼Œå†æŒ‰æ€»å¾—åˆ†é™åºå±•ç¤ºï¼Œä½†ä¸æ”¹å˜æ’åã€‚
ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
äºŒã€Golangå¼€å‘ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¼•å…¥éœ€è¦çš„åŒ…ï¼š
package main import ( &amp;quot;fmt&amp;quot; &amp;quot;log&amp;quot; &amp;quot;path/filepath&amp;quot; &amp;quot;sort&amp;quot; &amp;quot;github.com/tealeg/xlsx&amp;quot; ) æ¥ä¸‹æ¥ï¼Œè·å–æ‰€æœ‰Excelæ–‡ä»¶çš„è·¯å¾„ï¼š
func getExcelFiles() []string { files, err := filepath.Glob(&amp;quot;./æ ·ä¾‹æ•°æ®/*.xlsx&amp;quot;) if err != nil { log.Fatal(err) } return files } ç„¶åï¼Œå°†å„è¡¨æ•°æ®åˆå¹¶åˆ°ä¸»ç»“æ„ä½“ï¼š
// Record ç»“æ„ä½“è¡¨ç¤ºæ¯ä¸ªäººçš„è®°å½• type Record struct { Name string Monthly int Points int Ranking int } func getCellValue(cell *xlsx.Cell) int { value, err := cell.Int() if err != nil { log.Fatal(err) } return value } func mergeData(files []string) []Record { var mergedData []Record for _, file := range files { // è¯»å–Excelæ–‡ä»¶ xlFile, err := xlsx.</description></item><item><title>å†™ç»™goå¼€å‘è€…çš„Tarsæ•™ç¨‹-Tarsåè®®åŸºç¡€</title><link>/2023/06/18/tarsgo-protocol/</link><pubDate>Sun, 18 Jun 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/06/18/tarsgo-protocol/</guid><description>ç®€ä»‹ Tarsè¿™ä¸ªåå­—å–è‡ªäºç”µå½±&amp;quot;æ˜Ÿé™…ç©¿è¶Š&amp;quot;ä¸­çš„æœºå™¨äººï¼Œå®ƒæ˜¯åŸºäºåå­—æœåŠ¡ä½¿ç”¨Tarsåè®®çš„é«˜æ€§èƒ½RPCå¼€å‘æ¡†æ¶ï¼Œé…å¥—ä¸€ä½“åŒ–çš„è¿è¥ç®¡ç†å¹³å°ï¼Œå¹¶é€šè¿‡ä¼¸ç¼©è°ƒåº¦ï¼Œå®ç°è¿ç»´åŠæ‰˜ç®¡æœåŠ¡ã€‚
Tarsæ˜¯è…¾è®¯ä»2008å¹´åˆ°ä»Šå¤©ä¸€ç›´åœ¨ä½¿ç”¨çš„åå°é€»è¾‘å±‚çš„ç»Ÿä¸€åº”ç”¨æ¡†æ¶TAFï¼ˆTotal Application Frameworkï¼‰ï¼Œç›®å‰æ”¯æŒC++ã€Javaã€PHPã€Nodejsã€Goè¯­è¨€ã€‚è¯¥æ¡†æ¶ä¸ºç”¨æˆ·æä¾›äº†æ¶‰åŠåˆ°å¼€å‘ã€è¿ç»´ã€ä»¥åŠæµ‹è¯•çš„ä¸€æ•´å¥—è§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©ä¸€ä¸ªäº§å“æˆ–è€…æœåŠ¡å¿«é€Ÿå¼€å‘ã€éƒ¨ç½²ã€æµ‹è¯•ã€ä¸Šçº¿ã€‚ å®ƒé›†å¯æ‰©å±•åè®®ç¼–è§£ç ã€é«˜æ€§èƒ½RPCé€šä¿¡æ¡†æ¶ã€åå­—è·¯ç”±ä¸å‘ç°ã€å‘å¸ƒç›‘æ§ã€æ—¥å¿—ç»Ÿè®¡ã€é…ç½®ç®¡ç†ç­‰äºä¸€ä½“ï¼Œé€šè¿‡å®ƒå¯ä»¥å¿«é€Ÿç”¨å¾®æœåŠ¡çš„æ–¹å¼æ„å»ºè‡ªå·±çš„ç¨³å®šå¯é çš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œå¹¶å®ç°å®Œæ•´æœ‰æ•ˆçš„æœåŠ¡æ²»ç†ã€‚
ç›®å‰è¯¥æ¡†æ¶åœ¨è…¾è®¯å†…éƒ¨ï¼Œå„å¤§æ ¸å¿ƒä¸šåŠ¡éƒ½åœ¨ä½¿ç”¨ï¼Œé¢‡å—æ¬¢è¿ï¼ŒåŸºäºè¯¥æ¡†æ¶éƒ¨ç½²è¿è¡Œçš„æœåŠ¡èŠ‚ç‚¹è§„æ¨¡è¾¾åˆ°ä¸Šä¸‡ä¸ªã€‚
æ”¯æŒå¹³å° ç›®å‰è¿è¡Œçš„æ“ä½œç³»ç»Ÿå¹³å°å¦‚ä¸‹ï¼š
Linux
Mac(&amp;gt;=2.1.0 support)
æ”¯æŒè¯­è¨€ ç›®å‰æ”¯æŒçš„å¼€å‘è¯­è¨€å¦‚ä¸‹ï¼š
C++
Java
Nodejs
PHP
Go
ç‰ˆæœ¬ç®¡ç† Tarsç”±å¤šç§æ¨¡å—ç»„æˆ, åˆ†æ•£åœ¨å¤šä¸ªä»“åº“ä¸­, å¹¶ä¸”åŸºç¡€æ¡†æ¶ç‰ˆæœ¬å’Œè¯­è¨€ç‰ˆæœ¬å¯ä»¥ç‹¬ç«‹å‘å±•, é‰´äºæ­¤, ä»2.1.0ç‰ˆæœ¬å¼€å§‹, æ¡†æ¶çš„ç‰ˆæœ¬TAGæ‰“åœ¨TarsFrameworkä»“åº“ä¸Š, ä¸å†ä½“ç°åœ¨Tarsè¿™ä¸ªä»“åº“ä¸Š.
Tars IDL æ‰€è°“åºåˆ—åŒ–é€šä¿—æ¥è¯´å°±æ˜¯æŠŠå†…å­˜çš„ä¸€æ®µæ•°æ®è½¬åŒ–æˆäºŒè¿›åˆ¶å¹¶å­˜å‚¨æˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œè€Œè¯»å–ç£ç›˜æˆ–å¦ä¸€ç«¯æ”¶åˆ°åå¯ä»¥åœ¨å†…å­˜ä¸­é‡å»ºè¿™æ®µæ•°æ®
1ã€tarsåè®®æ˜¯è·¨è¯­è¨€è·¨å¹³å°çš„åºåˆ—åŒ–åè®®ã€‚
2ã€tarsåè®®æœ¬èº«ä¹Ÿå¯ä»¥è¢«ç”¨äºéRPCåœºæ™¯ï¼Œå¦‚å­˜å‚¨
jsonã€ xmléƒ½æ˜¯ä¸€ç§åºåˆ—åŒ–çš„æ–¹å¼ï¼Œåªæ˜¯ä»–ä»¬ä¸éœ€è¦æå‰é¢„å®šä¹‰idlï¼Œä¸”å…·å¤‡å¯è¯»æ€§ï¼Œå½“ç„¶ä»–ä»¬ä¼ è¾“çš„ä½“ç§¯ä¹Ÿå› æ­¤è¾ƒå¤§ï¼Œå¯ä»¥è¯´æ˜¯å„æœ‰ä¼˜åŠ£ã€‚
å…³é”®å­— void,struct,bool,byte,short,int,double,float,long,string,vector,map,key,routekey,module,interface,out,require,optional,false,true,enum,const æ³¨é‡Š é‡‡ç”¨ c++çš„æ³¨é‡Šè§„èŒƒï¼š
//è¡¨ç¤ºæ³¨é‡Šä¸€è¡Œ /**/è¡¨ç¤ºæ³¨é‡ŠèŒƒå›´ä¸­çš„æ‰€æœ‰ä»£ç ã€‚ åŸºæœ¬ç±»å‹ åŸºæœ¬ç±»å‹ä¼šæ¶‰åŠåˆ°ä¸åŒè¯­è¨€å’Œç¼–ç æ–¹å¼ï¼Œè¿™é‡Œåªæ•´ç†tarså’Œgoç±»å‹å¯¹ç…§è¡¨
.tars Type Go Type Notes void å‡½æ•°æ— è¿”å›å€¼ åªèƒ½åœ¨å‡½æ•°çš„è¿”å›å€¼è¡¨ç¤º bool bool å¸ƒå°”ç±»å‹ byte int8 æœ‰ç¬¦å·å­—ç¬¦ unsigned byte uint8 æ— ç¬¦å·å­—ç¬¦ short int16 æœ‰ç¬¦å·çŸ­æ•´å‹ unsigned short uint16 æ— ç¬¦å·çŸ­æ•´å½¢ int int32 æœ‰ç¬¦å·æ•´å‹ unsigned int uint32 æ— ç¬¦å·æ•´å½¢ long int64 æœ‰ç¬¦å·é•¿æ•´å‹ float float32 32ä½æµ®ç‚¹æ•° double float64 64ä½æµ®ç‚¹æ•° string string å­—ç¬¦ä¸² å¤æ‚ç±»å‹ .</description></item><item><title>å†™ç»™Goå¼€å‘è€…çš„Tarsæ•™ç¨‹-é€šä¿¡æ¨¡å¼</title><link>/2023/06/18/tarsgo-rpc/</link><pubDate>Sun, 18 Jun 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/06/18/tarsgo-rpc/</guid><description>æœ¬ç¯‡ä¸ºã€å†™ç»™Goå¼€å‘è€…çš„Tarsæ•™ç¨‹ç³»åˆ—ã€‘ç¬¬äºŒç¯‡
ç¬¬ä¸€ç¯‡ï¼šTarsåè®®åŸºç¡€ ç¬¬äºŒç¯‡ï¼šé€šä¿¡æ¨¡å¼ ä¸Šä¸€ç¯‡ä»‹ç»äº†å¦‚ä½•ç¼–å†™ Tars çš„ idlï¼Œå¹¶ä½¿ç”¨ idl ç”Ÿæˆäº† TarsGo RPC çš„ä»£ç ï¼Œç°åœ¨æ¥çœ‹çœ‹å¦‚ä½•ç¼–å†™å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ä»£ç 
Tars ç¤ºä¾‹ IDL module order { struct Order { 1 require string id; 2 optional vector&amp;lt;string&amp;gt; items; 3 optional string description; 4 require float price; 5 optional string destination; }; interface OrderManagement { Order getOrder(string orderId); }; }; ç”Ÿæˆ go åè®®ç¼–è§£ç ä»£ç  tars2go -outdir=. \ -module=github.com/lbbniu/TarsGo-tutorial \ proto/order.tars order â”œâ”€â”€ order.go â””â”€â”€ OrderManagement.tars.go proto â””â”€â”€ order.tars server å®ç° æœåŠ¡ç«¯å¼€å‘ 1ã€ç”± Tars æ–‡ä»¶ç”Ÿæˆçš„ Go ä»£ç ä¸­åŒ…å«äº† interface çš„æ¥å£å®šä¹‰ï¼Œå®ƒå’Œæˆ‘ä»¬å®šä¹‰çš„ idl æ˜¯å»åˆçš„</description></item><item><title>Redis Cluster vs Codis Slot Rebalance ç®—æ³•</title><link>/2023/03/26/redis-cluster-vs-codis-slot-rebalance-%E7%AE%97%E6%B3%95/</link><pubDate>Sun, 26 Mar 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/03/26/redis-cluster-vs-codis-slot-rebalance-%E7%AE%97%E6%B3%95/</guid><description>Redis Cluster Slot Rebalanceç®—æ³• è¿ç§»åŸåˆ™ å°½å¯èƒ½çš„å‡åŒ€åˆ†é…Slotsï¼› å°½é‡å‡å°‘è¿ç§»çš„Slotsçš„æ•°é‡ï¼› Slotsåˆ†é…æ–¹æ¡ˆ è®¡ç®—é›†ç¾¤çš„æ€»æƒé‡ï¼ŒèŠ‚ç‚¹æ•°é‡ï¼› è®¡ç®—æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹éœ€è¦ç§»å‡ºæˆ–ç§»å…¥çš„æ§½æ•°ï¼Œbalance å¦‚æœä¸ºæ­£æ•°ä»£è¡¨éœ€è¦ç§»å‡ºçš„æ§½æ•°ï¼Œå¦‚æœä¸ºè´Ÿæ•°ä»£è¡¨éœ€è¦å‡ºå…¥æ§½æ•°ï¼› æŠŠweightedNodes æ ¹æ® balance æ’åºä»å°åˆ°å¤§ï¼› æ‰§è¡Œæ§½ä½ç§»åŠ¨ï¼Œå¹¶æ›´æ–°é›†ç¾¤èŠ‚ç‚¹ balanceï¼› ä»£ç å®ç° static int clusterManagerCommandRebalance(int argc, char **argv) { int port = 0; char *ip = NULL; clusterManagerNode **weightedNodes = NULL; list *involved = NULL; if (!getClusterHostFromCmdArgs(argc, argv, &amp;amp;ip, &amp;amp;port)) goto invalid_args; clusterManagerNode *node = clusterManagerNewNode(ip, port, 0); if (!clusterManagerLoadInfoFromNode(node)) return 0; int result = 1, i; if (config.cluster_manager_command.weight != NULL) { for (i = 0; i &amp;lt; config.cluster_manager_command.weight_argc; i++) { char *name = config.</description></item><item><title>Golangè¯­æ³•çš„25ä¸ªç»ƒä¹ é¢˜ï¼š21è‡³25é¢˜</title><link>/2023/02/24/uri-addr/</link><pubDate>Fri, 24 Feb 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/02/24/uri-addr/</guid><description>é¢˜ç›®21ï¼šä¸‰ä¸ªæ•°å–æœ€å¤§æ•° å·±çŸ¥æ•°å­—aï¼Œbï¼Œcåˆ†åˆ«ä¸º10ï¼Œ6ï¼Œ18
æ‰¾å‡ºaï¼Œbï¼Œcä¸­æœ€å¤§çš„æ•°å­—(ä¸å€ŸåŠ©å‡½æ•°ä»¥åŠåˆ—è¡¨ç­‰æ–¹å¼)
æˆ‘ä»¬çŸ¥é“å‡½æ•°maxå¯ä»¥ç›´æ¥è·å–åˆ°æœ€å¤§å€¼ï¼Œæˆ–è€…å¯ä»¥æŠŠæ•°å­—æ·»åŠ åˆ°åˆ—è¡¨é‡Œï¼Œé€šè¿‡æ’åºä¹Ÿèƒ½è·å–åˆ°æœ€å¤§æ•°å­—ï¼Œæˆ‘ä»¬å•çº¯ä½¿ç”¨ifåˆ†æ”¯æ¥å®ç°
package main import &amp;quot;fmt&amp;quot; func main() { a, b, c := 10, 6, 8 max := a if max &amp;lt; b { max = b } if max &amp;lt; c { max = c } fmt.Println(max) } é¢˜ç›®22ï¼šå› å­ä¹‹å’Œâ€œå®Œæ•°â€ ä»€ä¹ˆæ˜¯å› å­ï¼Ÿ
å› å­å°±æ˜¯æ‰€æœ‰å¯ä»¥æ•´é™¤è¿™ä¸ªæ•°çš„æ•°å­—ï¼ŒåŒ…æ‹¬1ä½†ä¸åŒ…æ‹¬è¿™ä¸ªæ•°è‡ªèº«ã€‚æ¯”å¦‚8çš„å› å­æœ‰1ï¼Œ2ï¼Œ4
ä»€ä¹ˆæ˜¯å®Œæ•°ï¼Ÿ
ä¸€ä¸ªæ•°å¦‚æœæ°å¥½ç­‰äºå®ƒçš„å› å­ä¹‹å’Œï¼Œè¿™ä¸ªæ•°å°±ç§°ä¸ºâ€œå®Œæ•°â€ï¼Œæ‰“å°è¾“å‡º1000ä»¥å†…çš„å®Œæ•°ï¼Œä¾‹å¦‚6=1+2+3ï¼Œ6å°±æ˜¯â€œå®Œæ•°
package main import &amp;quot;fmt&amp;quot; func main() { for i := 1; i &amp;lt; 1000; i++ { if i == factorSum(i) { fmt.Println(&amp;quot;//&amp;quot;, i) } } // output: // 6 // 28 // 496 } func factorSum(n int) int { sum := 0 for i := 1; i &amp;lt; n; i++ { if n%i == 0 { sum += i } } return sum } é¢˜ç›®23ï¼šé€’å½’é˜¶ä¹˜æ±‚å’Œ ä¸€ä¸ªæ­£æ•´æ•°çš„é˜¶ä¹˜(factorial)æ˜¯æ‰€æœ‰å°äºåŠç­‰äºè¯¥æ•°çš„æ­£æ•´æ•°ä¹‹ç§¯ï¼Œå¹¶ä¸”0çš„é˜¶ä¹˜ä¸º1</description></item><item><title>Golangè¯­æ³•çš„25ä¸ªç»ƒä¹ é¢˜ï¼š16è‡³20é¢˜</title><link>/2023/02/23/uri-addr/</link><pubDate>Thu, 23 Feb 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/02/23/uri-addr/</guid><description>é¢˜ç›®16ï¼šå¤§è¡æ•°åˆ— ä¸­å›½å¤ä»£æ–‡çŒ®ä¸­ï¼Œæ›¾è®°è½½è¿‡â€œå¤§è¡æ•°åˆ—â€ï¼Œä¸»è¦ç”¨äºè§£é‡Šä¸­å›½ä¼ ç»Ÿæ–‡åŒ–ä¸­çš„å¤ªæè¡ç”ŸåŸç†
å®ƒçš„å‰å‡ é¡¹æ˜¯ï¼š0ã€2ã€4ã€8ã€12ã€18ã€24ã€32ã€40ã€50&amp;hellip;
å…¶è§„å¾‹æ˜¯ï¼šå¶æ•°é¡¹ï¼Œæ˜¯åºå·å¹³æ–¹å†é™¤2ï¼Œå¥‡æ•°é¡¹ï¼Œæ˜¯åºå·å¹³æ–¹å‡1å†é™¤2ã€‚
æ‰“å°å¤§è¡æ•°åˆ—çš„å‰100é¡¹
package main import ( &amp;quot;fmt&amp;quot; &amp;quot;math&amp;quot; ) func main() { for i := 1; i &amp;lt;= 100; i++ { var a int if i%2 == 0 { // å¶æ•° a = int(math.Pow(float64(i), 2)) / 2 } else { // å¥‡æ•° a = (int(math.Pow(float64(i), 2)) - 1) / 2 } fmt.Println(&amp;quot;//&amp;quot;, a) } // 0 // 2 // 4 // 8 // 12 // 18 // 24 // 32 // 40 // 50 } é¢˜ç›®17ï¼šå•è¯åˆ†æ å°è“æ­£åœ¨å­¦ä¹ ä¸€é—¨ç¥å¥‡çš„è¯­è¨€ï¼Œè¿™é—¨è¯­è¨€ä¸­çš„å•è¯éƒ½æ˜¯ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆï¼Œæœ‰äº›å•è¯å¾ˆé•¿ï¼Œè¿œè¿œè¶…è¿‡æ­£å¸¸è‹±æ–‡å•è¯çš„é•¿åº¦ã€‚å°è“å­¦äº†å¾ˆé•¿æ—¶é—´ä¹Ÿè®°ä¸ä½ä¸€äº›å•è¯ï¼Œä»–å‡†å¤‡ä¸å†å®Œå…¨è®°å¿†è¿™äº›å•è¯ï¼Œè€Œæ˜¯æ ¹æ®å•è¯ä¸­å“ªä¸ªå­—æ¯å‡ºç°å¾—æœ€å¤šæ¥åˆ†è¾¨å•è¯ ç°åœ¨ï¼Œè¯·ä½ å¸®åŠ©å°è“ï¼Œç»™äº†ä¸€ä¸ªå•è¯åï¼Œå¸®åŠ©ä»–æ‰¾åˆ°å‡ºç°æœ€å¤šçš„å­—æ¯å’Œè¿™ä¸ªå­—æ¯å‡ºç°çš„æ¬¡æ•° å…¶å®å°±æ˜¯è®©ä½ è¾“å…¥ä¸€æ®µå­—ç¬¦ä¸²åï¼Œå¾—åˆ°å½“å‰å­—ç¬¦ä¸²å‡ºç°æœ€å¤šçš„å­—æ¯å’Œå®ƒçš„æ¬¡æ•° è¾“å…¥ï¼šHelloWorld è¾“å‡ºï¼š l 3 æˆ‘ä»¬å¯ä»¥å¯¹å½“å‰çš„å­—ç¬¦ä¸²è¿›è¡Œå¾ªç¯è¿­ä»£ï¼Œç„¶åæŠŠå­—ç¬¦ä¸²å½“å‰æ¯ä¸ªå­—ç¬¦å½“ä½œkeyå€¼ï¼ŒæŠŠå®ƒå­˜åˆ°å­—å…¸é‡Œé¢ï¼Œå¦‚æœå½“å‰keyåœ¨å­—å…¸é‡Œé¢ï¼Œæˆ‘ä»¬å°±è®©å®ƒåŠ ä¸€ï¼Œå¦‚æœä¸åœ¨é‚£æˆ‘ä»¬å°±è®©å®ƒçš„æ¬¡æ•°åˆå§‹åŒ–ä¸º1ï¼Œæœ€ç»ˆæˆ‘ä»¬å†ä»å­—å…¸æ‰¾åˆ°æ¬¡æ•°æœ€å¤šçš„keyå€¼å’Œvalueå€¼ package main import &amp;quot;fmt&amp;quot; func main() { analyseWords(&amp;quot;helloworld&amp;quot;) // l 3 } func analyseWords(word string) { wordDict := map[rune]int{} var ( count int ch rune ) for _, c := range word { wordDict[c]++ if wordDict[c] &amp;gt; count { count, ch = wordDict[c], c } } fmt.</description></item><item><title>Golangè¯­æ³•çš„25ä¸ªç»ƒä¹ é¢˜ï¼š11è‡³15é¢˜</title><link>/2023/02/22/uri-addr/</link><pubDate>Wed, 22 Feb 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/02/22/uri-addr/</guid><description>é¢˜ç›®11ï¼šå‰ªåˆ€çŸ³å¤´å¸ƒ æ¸¸æˆå¼€å§‹ï¼Œåˆå§‹çŠ¶æ€ä¸‹ç”¨æˆ·å’Œç”µè„‘éƒ½æœ‰100åˆ†ï¼Œèµ¢ä¸€å±€+10åˆ†ï¼Œè¾“ä¸€å±€-10åˆ†ã€‚å½“ç”¨æˆ·ä¸º0åˆ†æ—¶ï¼Œæ¸¸æˆç»“æŸï¼Œæç¤ºæ¸¸æˆç»“æŸï¼Œæ¯”èµ›è¾“äº†ï¼Œå½“ç”¨æˆ·ä¸º200åˆ†æ—¶ï¼Œæ¸¸æˆç»“æŸï¼Œæç¤ºæ¸¸æˆç»“æŸï¼Œèµ¢å¾—æ¯”èµ›ã€æ¯è½®æ¯”èµ›éƒ½è¾“å‡ºå½“å‰çš„åˆ†æ•°
1ä»£è¡¨å‰ªåˆ€ 2ä»£è¡¨çŸ³å¤´ 3ä»£è¡¨å¸ƒ
package main import ( &amp;quot;fmt&amp;quot; &amp;quot;math/rand&amp;quot; &amp;quot;os&amp;quot; &amp;quot;strconv&amp;quot; &amp;quot;strings&amp;quot; &amp;quot;time&amp;quot; ) var ( gameInfo = map[int]string{ 1: &amp;quot;å‰ªåˆ€&amp;quot;, 2: &amp;quot;çŸ³å¤´&amp;quot;, 3: &amp;quot;å¸ƒ&amp;quot;, } score = 100 ) func main() { fmt.Println(strings.Repeat(&amp;quot;=&amp;quot;, 60)) fmt.Println(strings.Repeat(&amp;quot; &amp;quot;, 20), &amp;quot;å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆ&amp;quot;) fmt.Println(&amp;quot;1ä»£è¡¨å‰ªåˆ€ 2ä»£è¡¨çŸ³å¤´ 3ä»£è¡¨å¸ƒ&amp;quot;) for { rd := rand.New(rand.NewSource(time.Now().UnixNano())) robotsChoice := rd.Intn(3) if robotsChoice == 0 { robotsChoice++ } userChoice, err := input(&amp;quot;è¯·å‡ºæ‹³&amp;quot;) if err != nil { fmt.Println(err) continue } if _, ok := gameInfo[userChoice]; !</description></item><item><title>Golangè¯­æ³•çš„25ä¸ªç»ƒä¹ é¢˜ï¼š6è‡³10é¢˜</title><link>/2023/02/15/uri-addr/</link><pubDate>Wed, 15 Feb 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/02/15/uri-addr/</guid><description>é¢˜ç›®6ï¼šé—°å¹´é—®é¢˜å‡çº§ç‰ˆ è¾“å…¥å¹´æœˆæ—¥ï¼Œè¾“å‡ºè¯¥æ—¥æœŸæ˜¯å¦æ˜¯é—°å¹´ï¼Œå¹¶ä¸”è¾“å‡ºè¯¥æ—¥æœŸæ˜¯æ­¤å¹´ä»½çš„ç¬¬å‡ å¤©
é—°å¹´åˆ¤æ–­æ¡ä»¶ï¼š
èƒ½è¢«4æ•´é™¤ï¼Œå¹¶ä¸”ä¸èƒ½è¢«100æ•´é™¤ èƒ½è¢«400æ•´é™¤ ä¸¤ä¸ªæ¡ä»¶æ»¡è¶³ä»»æ„ä¸€ä¸ªå°±ä¸ºé—°å¹´ ç®—æ³•æ€è·¯
æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å¹´æœˆæ—¥ï¼Œåˆ›å»ºä¿å­˜12ä¸ªæœˆä»½å¤©æ•°çš„åˆ—è¡¨ æ ¹æ®å¹´ä»½åˆ¤æ–­æ˜¯å¦æ˜¯é—°å¹´ï¼Œå¦‚æœæ˜¯æŠŠäºŒæœˆä»½è®¾ä¸º29å¤©ï¼Œå¦åˆ™æŠŠäºŒæœˆä»½è®¾ä¸º28å¤© æ ¹æ®æœˆä»½å’Œæ—¥æœŸç»Ÿè®¡æ˜¯å½“å¹´çš„ç¬¬å‡ å¤© package main import ( &amp;quot;fmt&amp;quot; &amp;quot;log&amp;quot; &amp;quot;os&amp;quot; &amp;quot;strconv&amp;quot; ) func main() { year, err := input(&amp;quot;è¯·è¾“å…¥å¹´ä»½&amp;quot;) if err != nil { log.Fatalln(err) } month, err := input(&amp;quot;è¯·è¾“å…¥æœˆä»½&amp;quot;) if err != nil { log.Fatalln(err) } day, err := input(&amp;quot;è¯·è¾“å…¥æ—¥æœŸ&amp;quot;) if err != nil { log.Fatalln(err) } dateList := []int{31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31} countDay := day if year%4 == 0 &amp;amp;&amp;amp; year%100 !</description></item><item><title>Golangè¯­æ³•çš„25ä¸ªç»ƒä¹ é¢˜ï¼š1è‡³5é¢˜</title><link>/2023/02/13/uri-addr/</link><pubDate>Mon, 13 Feb 2023 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/02/13/uri-addr/</guid><description>é¢˜ç›®1ï¼šæ°´ä»™èŠ±æ•° æ°´ä»™èŠ±æ•°ï¼ˆNarcissistic numberï¼‰ä¹Ÿè¢«ç§°ä¸ºè¶…å®Œå…¨æ•°å­—ä¸å˜æ•°ï¼ˆpluperfect digital invariant, PPDIï¼‰ã€è‡ªæ‹æ•°ã€è‡ªå¹‚æ•°ã€é˜¿å§†æ–¯å£®æ•°æˆ–é˜¿å§†æ–¯ç‰¹æœ—æ•°ï¼ˆArmstrong numberï¼‰ï¼Œæ°´ä»™èŠ±æ•°æ˜¯æŒ‡ä¸€ä¸ª 3 ä½æ•°ï¼Œå®ƒçš„æ¯ä¸ªä½ä¸Šçš„æ•°å­—çš„ 3æ¬¡å¹‚ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ã€‚ä¾‹å¦‚ï¼š1^3 + 5^3+ 3^3 = 153ã€‚
package main import ( &amp;quot;fmt&amp;quot; &amp;quot;math&amp;quot; ) func main() { // å†™æ³•ä¸€ for i := 100; i &amp;lt; 1000; i++ { // å–ç™¾ä½æ•°å­— 123//100=1 // å–åä½æ•°å­— 123//10=12 12%10=2 // å–ä¸ªä½æ•°å­— 123%10=3 i1, i2, i3 := i/100, i/10%10, i%10 if int(math.Pow(float64(i1), 3)+math.Pow(float64(i2), 3)+math.Pow(float64(i3), 3)) == i { fmt.Printf(&amp;quot;%dæ˜¯æ°´ä»™èŠ±æ•°\n&amp;quot;, i) // 153 æ˜¯æ°´ä»™èŠ±æ•° // 370 æ˜¯æ°´ä»™èŠ±æ•° // 371 æ˜¯æ°´ä»™èŠ±æ•° // 407 æ˜¯æ°´ä»™èŠ±æ•° } } // å†™æ³•äºŒ for i := 1000; i &amp;lt; 10000; i++ { sum := 0 for k := i; k &amp;gt; 0; k = k / 10 { // ä¸ªåç™¾ sum += int(math.</description></item><item><title>ä¸€ç¯‡æ–‡ç« ç²¾é€šphpå¤šç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼šphpbrew</title><link>/2023/01/04/phpbrew/</link><pubDate>Wed, 04 Jan 2023 22:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2023/01/04/phpbrew/</guid><description>phpbrewæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥åœ¨$HOMEç›®å½•ä¸­æ„å»ºå’Œå®‰è£…å¤šä¸ªPHPç‰ˆæœ¬ã€‚
phpbrewçš„åŠŸèƒ½åŒ…æ‹¬ï¼š
å°†é…ç½®é€‰é¡¹ç®€åŒ–ä¸ºå˜ä½“ï¼Œä¸å†æ‹…å¿ƒè·¯å¾„é—®é¢˜ã€‚ ä½¿ç”¨ä¸åŒçš„å˜ä½“æ„å»ºPHPï¼Œå¦‚PDOã€mysqlã€sqliteã€debugç­‰ã€‚ ç¼–è¯‘Apache PHPæ¨¡å—ï¼Œå¹¶æŒ‰ä¸åŒç‰ˆæœ¬åˆ†å¼€ã€‚ åœ¨ä¸ªäººç›®å½•ä¸­æ„å»ºå’Œå®‰è£…PHPï¼Œæ— éœ€rootæƒé™ã€‚ è½»æ¾åˆ‡æ¢ç‰ˆæœ¬ï¼Œä¸bash/zsh shellé›†æˆã€‚ è‡ªåŠ¨åŠŸèƒ½æ£€æµ‹ã€‚ è½»æ¾åœ¨å½“å‰ç¯å¢ƒä¸­å®‰è£…å’Œå¯ç”¨PHPæ‰©å±•ã€‚ åœ¨ç³»ç»ŸèŒƒå›´å†…å®‰è£…å¤šä¸ªPHPã€‚ é’ˆå¯¹HomeBrewå’ŒMacPortsçš„è·¯å¾„æ£€æµ‹ä¼˜åŒ–ã€‚ è¦æ±‚ è¯·æŸ¥çœ‹ Requirement åœ¨å¼€å§‹ä¹‹å‰ã€‚ä½ éœ€è¦å®‰è£…ä¸€äº›ç”¨äºæ„å»º PHP çš„å¼€å‘åŒ…ã€‚
å®‰è£… åªéœ€ä¸‹è½½å®ƒï¼š
curl -L -O https://github.com/phpbrew/phpbrew/releases/latest/download/phpbrew.phar chmod +x phpbrew.phar ç„¶åï¼Œä½ å¯ä»¥å°†å…¶å®‰è£…åˆ° bin æ–‡ä»¶å¤¹ä¸­ï¼š
sudo mv phpbrew.phar /usr/local/bin/phpbrew ç¡®ä¿åœ¨ä½ çš„ $PATH ç¯å¢ƒå˜é‡ä¸­æœ‰ /usr/local/binã€‚
è®¾ç½® åˆå§‹åŒ–ä¸€ä¸ªç”¨äºä½ çš„ shell ç¯å¢ƒçš„ bash è„šæœ¬ï¼š
phpbrew init å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°ä½ çš„ .bashrc æˆ– .zshrc æ–‡ä»¶ï¼š
[[ -e ~/.phpbrew/bashrc ]] &amp;amp;&amp;amp; source ~/.phpbrew/bashrc è®¾ç½®æŸ¥æ‰¾å‰ç¼€ ä½ å¯ä»¥è®¾ç½®ä½ é¦–é€‰çš„ç”¨äºæŸ¥æ‰¾åº“çš„é»˜è®¤å‰ç¼€ï¼Œå¯ç”¨é€‰é¡¹æœ‰ macportsã€homebrewã€debianã€ubuntu æˆ–è‡ªå®šä¹‰è·¯å¾„ï¼š
å¯¹äº Homebrew ç”¨æˆ·ï¼š
phpbrew lookup-prefix homebrew å¯¹äº Macports ç”¨æˆ·ï¼š
phpbrew lookup-prefix macports åŸºæœ¬ç”¨æ³• åˆ—å‡ºå·²çŸ¥ç‰ˆæœ¬ï¼š</description></item><item><title>polaris-go æºç èµ°è¯»</title><link>/2022/10/28/polaris-go/</link><pubDate>Fri, 28 Oct 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/10/28/polaris-go/</guid><description>provider å®ä¾‹åŒ–ProviderAPI NewProviderAPI() -&amp;gt; æ ¹æ®é»˜è®¤é…ç½®æ–‡ä»¶./polaris.yaml å®ä¾‹åŒ– api.newProviderAPI-&amp;gt;api.newProviderAPIByConfig-&amp;gt;api.InitContextByConfig-&amp;gt;[api.newProviderAPIByContext]-&amp;gt;&amp;amp;providerAPI{rawAPI: p} NewProviderAPIByFile(path string) -&amp;gt; æ ¹æ®æŒ‡å®šé…ç½®æ–‡ä»¶å®ä¾‹åŒ– api.newProviderAPIByFile-&amp;gt;api.InitContextByFile-&amp;gt;api.InitContextByStream-&amp;gt;api.InitContextByConfig-&amp;gt;[api.newProviderAPIByContext]-&amp;gt;&amp;amp;providerAPI{rawAPI: p} NewProviderAPIByConfig(cfg config.Configuration) -&amp;gt; æ ¹æ®æŒ‡å®šé…ç½®å®ä¾‹åŒ– api.newProviderAPIByConfig-&amp;gt;api.InitContextByConfig-&amp;gt;[api.newProviderAPIByContext] NewProviderAPIByContext(context api.SDKContext) -&amp;gt; æ ¹æ®æŒ‡å®šapi.SDKContextå®ä¾‹åŒ– api.newProviderAPIByContext-&amp;gt;&amp;amp;providerAPI{rawAPI: p} NewProviderAPIByAddress(address &amp;hellip;string) -&amp;gt; æ ¹æ®æŒ‡å®š polaris-server åœ°å€å®ä¾‹åŒ– api.newProviderAPIByAddress-&amp;gt;[config.NewDefaultConfiguration]-&amp;gt;api.newProviderAPIByConfig-&amp;gt;api.InitContextByConfig-&amp;gt;[api.newProviderAPIByContext]-&amp;gt;&amp;amp;providerAPI{rawAPI: p} ä»¥ä¸Šæ‰€æœ‰æ–¹æ³•æœ€ç»ˆéƒ½ä¼šèµ°åˆ°api.newProviderAPIByContexæ–¹æ³•, ç„¶åè¿”å›&amp;amp;providerAPI{rawAPI: p}
![image-20221104120449226](/Users/lbbniu/Library/Application Support/typora-user-images/image-20221104120449226.png)
ç›¸å…³æ¥å£å®šä¹‰ // ProviderAPI CL5æœåŠ¡ç«¯APIçš„ä¸»æ¥å£ type ProviderAPI interface { // RegisterInstance // minimum supported version of polaris-server is v1.10.0 RegisterInstance(instance *InstanceRegisterRequest) (*model.InstanceRegisterResponse, error) // Deregister synchronize the anti registration service Deregister(instance *InstanceDeRegisterRequest) error // Destroy the api is destroyed and cannot be called again Destroy() } RegisterInstance // providerAPI è°ƒç”¨è€…å¯¹å¤–å‡½æ•°å®ç° type providerAPI struct { rawAPI api.</description></item><item><title>Go å®æˆ˜è®­ç»ƒè¥â€”â€”å¼€æºé¡¹ç›®å­¦ä¹ è®¡åˆ’</title><link>/2022/06/26/open-source-study/</link><pubDate>Sun, 26 Jun 2022 14:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/06/26/open-source-study/</guid><description>Go å®æˆ˜è®­ç»ƒè¥0æœŸï¼š https://shimo.im/docs/3GP6Kwsdm5It9UOV Goå®æˆ˜è®­ç»ƒè¥1æœŸï¼š https://shimo.im/docs/rqizHOhKFrUQKG42/read å¼€æºé¡¹ç›® Webï¼š Beegoï¼šhttps://github.com/beego/beego httprouterï¼šhttps://github.com/julienschmidt/httprouter Ginï¼šhttps://github.com/gin-gonic/gin å¾®æœåŠ¡ï¼š Dubbo-goï¼šhttps://github.com/apache/dubbo-go Kratosï¼šhttps://github.com/go-kratos/kratos gRPCï¼šhttps://github.com/grpc/grpc-go ormï¼š GORMï¼šhttps://github.com/go-gorm/gorm ENTï¼šhttps://github.com/ent/ent redsyncï¼šhttps://github.com/go-redsync/redsync bytebufferpoolï¼šhttps://github.com/valyala/bytebufferpool errgroupï¼š https://cs.opensource.google/go/x/sync https://pkg.go.dev/golang.org/x/sync/errgroup å…³æ³¨å…¬ä¼—å·è·å¾—æ›´å¤šç²¾å½©æ–‡ç« </description></item><item><title>ã€è…¾è®¯äº‘ Finops Crane é›†è®­è¥ã€‘EHPAæ§åˆ¶å™¨æ ¸å¿ƒæºç åˆ†æ</title><link>/2022/02/15/crane-ehpa-code/</link><pubDate>Tue, 15 Feb 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/02/15/crane-ehpa-code/</guid><description>å®˜æ–¹æ–‡æ¡£ï¼šhttps://gocrane.io/ Githubï¼š https://github.com/gocrane/crane å¯åŠ¨æµç¨‹ main å‡½æ•° craned å¯åŠ¨å…¥å£åœ¨cmd/craned/main.goæ–‡ä»¶ä¸­ï¼Œmainæ–¹æ³•ä»£ç å¦‚ä¸‹
func main() { logs.InitLogs() defer logs.FlushLogs() ctx := signals.SetupSignalHandler() if err := app.NewManagerCommand(ctx).Execute(); err != nil { fmt.Fprintf(os.Stderr, &amp;quot;%v\n&amp;quot;, err) os.Exit(1) } } ä¸‹é¢è¿›è¡Œé€è¡Œåˆ†æï¼š
2~3 è¡Œåˆå§‹åŒ–æ—¥å¿—ï¼Œå†å²deferåœ¨ç¨‹åºé€€å‡ºå‰åˆ·æ–°ç¼“å­˜åŒº 5è¡Œé€šè¿‡controller-runtimeåŒ…è·å–ä¿¡å·ç›‘å¬å¯å–æ¶ˆçš„context 7è¡Œåˆ›å»ºcobra.Commandå‘½ä»¤è¡Œå®ä¾‹å¹¶ç›´æ¥è°ƒç”¨Executeæ–¹æ³•å¯åŠ¨åº”ç”¨ï¼Œå¦‚æœå‡ºé”™é€€å‡ºç¨‹åº app.NewManagerCommandæ–¹æ³•åœ¨cmd/craned/app/manager.goæ–‡ä»¶ä¸­ï¼Œå‡½æ•°ä¸­ä¸»è¦æ˜¯åˆ›å»ºOptionså’Œcobra.Commandï¼Œå¹¶åˆå§‹åŒ–å‘½ä»¤è¡Œå‚æ•°é€‰é¡¹ã€‚cobra.Commandåœ¨æ‰§è¡Œçš„æ—¶å€™å›è°ƒç”¨cmd/craned/app/manager.goæ–‡ä»¶ä¸­çš„Runå‡½æ•°ã€‚
Run å‡½æ•° ä¸‹é¢æ¥é‡ç‚¹åˆ†æä¸‹Runå‡½æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š
// Run runs the craned with options. This should never exit. func Run(ctx context.Context, opts *options.Options) error { config := ctrl.GetConfigOrDie() config.QPS = float32(opts.ApiQps) config.Burst = opts.ApiBurst ctrlOptions := ctrl.Options{ Scheme: scheme, MetricsBindAddress: opts.MetricsAddr, Port: 9443, HealthProbeBindAddress: opts.</description></item><item><title>hugoio</title><link>/2022/02/15/uri-addr/</link><pubDate>Tue, 15 Feb 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/02/15/uri-addr/</guid><description>https://github.com/gohugoio/hugo/blob/0f8dc47037/hugolib/page__meta.go for k, v := range frontmatter { loki := strings.ToLower(k) if loki == &amp;quot;published&amp;quot; { // Intentionally undocumented vv, err := cast.ToBoolE(v) if err == nil { published = &amp;amp;vv } // published may also be a date continue } if pm.s.frontmatterHandler.IsDateKey(loki) { continue } switch loki { case &amp;quot;title&amp;quot;: pm.title = cast.ToString(v) pm.params[loki] = pm.title case &amp;quot;linktitle&amp;quot;: pm.linkTitle = cast.ToString(v) pm.params[loki] = pm.linkTitle case &amp;quot;summary&amp;quot;: pm.summary = cast.ToString(v) pm.params[loki] = pm.summary case &amp;quot;description&amp;quot;: pm.</description></item><item><title>pushgateway groupæ¸…ç†</title><link>/2022/02/15/pushgateway-group%E6%B8%85%E7%90%86/</link><pubDate>Tue, 15 Feb 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/02/15/pushgateway-group%E6%B8%85%E7%90%86/</guid><description>trap 'echo &amp;quot;got sigterm&amp;quot; ; exit 0' SIGTERM EXPIRATION_SECONDS=${EXPIRATION_SECONDS:-600} PGW_URL=${PGW_URL:-http://10.176.78.78:9091} function convert_to_standardnotation(){ # convert number from scientific notation to standar d( ie '1.5383780136826127e+09' ) printf '%.0f' $1 } function extract_pushgateway_variable(){ local -r _METRIC=$1 local -r _VARNAME=$2 #echo 'push_time_seconds{instance=&amp;quot;10.32.32.7&amp;quot;,job=&amp;quot;bk_jenkins&amp;quot;} 1.5383802210997093e+09' | sed -r 's/.*instance=&amp;quot;([^&amp;quot;]*).*/\1/g' echo $_METRIC | sed -r &amp;quot;s/.*${_VARNAME}=\&amp;quot;([^\&amp;quot;]*).*/\\1/g&amp;quot; # sample usage : # extract_pushgateway_variable 'push_time_seconds{instance=&amp;quot;10.32.32.7&amp;quot;,job=&amp;quot;bk_jenkins&amp;quot;} 1.5383802210997093e+09' 'instance' } function extract_pushgateway_uri(){ local -r _METRIC=$1 #echo 'push_time_seconds{instance=&amp;quot;10.32.32.7&amp;quot;,job=&amp;quot;bk_jenkins&amp;quot;} 1.5383802210997093e+09' | awk -F{ '{print $2}' | awk -F} '{print $1}' | sed -e &amp;quot;s/[=,]/\//g&amp;quot; -e &amp;quot;s/\&amp;quot;//g&amp;quot; metricJob=$(extract_pushgateway_variable &amp;quot;$_METRIC&amp;quot; 'job') echo $_METRIC | awk -F{ '{print $2}' | awk -F} '{print $1}' | sed -e &amp;quot;s/[=,]/\//g&amp;quot; -e &amp;quot;s/\&amp;quot;//g&amp;quot; -e &amp;quot;s/job\///g&amp;quot; -e &amp;quot;s/${metricJob}\///g&amp;quot; -e &amp;quot;s/instance\/\///g&amp;quot; # sample usage : # extract_pushgateway_uri 'push_time_seconds{instance=&amp;quot;10.</description></item><item><title>å¦‚ä½•å®ç° Service Weaver éƒ¨ç½²å™¨</title><link>/2022/02/15/deployers/</link><pubDate>Tue, 15 Feb 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/02/15/deployers/</guid><description>å£°æ˜ ä½œè€…èƒ½åŠ›æœ‰é™ï¼Œå¦‚æ„Ÿè§‰æœ‰ç¿»è¯‘ä¸å‡†ç¡®çš„è¯·ç§»æ­¥åŸæ–‡ã€‚
åŸæ–‡åœ°å€ï¼šhttps://serviceweaver.dev/blog/deployers.html ã€‚
Service Weaver å…è®¸æ‚¨ä»¥å¤šç§ä¸åŒçš„æ–¹å¼éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åœ¨å•ä¸ªè¿›ç¨‹ ã€è·¨å¤šä¸ªè¿›ç¨‹ æˆ–äº‘ ä¸­éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚æ¯«ä¸å¥‡æ€ªï¼Œéƒ¨ç½² Service Weaver åº”ç”¨ç¨‹åºçš„ä»£ç ç§°ä¸ºdeployerã€‚è¿™ç¯‡åšæ–‡è§£é‡Šäº†éƒ¨ç½²å™¨æ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•å®æ–½éƒ¨ç½²å™¨ã€‚æˆ‘ä»¬å‡è®¾æ‚¨ç†Ÿæ‚‰å¦‚ä½•ç¼–å†™ Service Weaver åº”ç”¨ç¨‹åºã€‚å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨é˜…è¯»åˆ†æ­¥æ•™ç¨‹ ã€‚
æ¦‚è¿° Service Weaver åº”ç”¨ç¨‹åºç”±è®¸å¤šç»„ä»¶ ç»„æˆã€‚è¯¥åº”ç”¨ç¨‹åºè¢«ç¼–è¯‘æˆå•ä¸ªåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚éƒ¨ç½²è€…é€šè¿‡å¤šæ¬¡è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶æ¥éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œé€šå¸¸æ˜¯è·¨å¤šå°æœºå™¨ã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„æ¯ä¸ªå®ä¾‹éƒ½è¿è¡Œç»„ä»¶çš„ä¸€ä¸ªå­é›†ã€‚ä¸ºäº†äº†è§£è¦è¿è¡Œå“ªäº›ç»„ä»¶ï¼ŒäºŒè¿›åˆ¶é“¾æ¥åœ¨ä¸€ä¸ªç§°ä¸º weavelet çš„å°å‹åå°ä»£ç†ä¸­ï¼Œéƒ¨ç½²è€…ä½¿ç”¨envelopeä¸ä¹‹é€šä¿¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†å¯¹weaveletsã€deployerså’Œenvelopesçš„é«˜çº§æ¦‚è¿°ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡å®Œå…¨ä»å¤´å¼€å§‹å®æ–½å¤šè¿›ç¨‹éƒ¨ç½²ç¨‹åºï¼Œæ·±å…¥äº†è§£å®ƒä»¬çš„å·¥ä½œåŸç†ã€‚
Weavelets è¦äº†è§£éƒ¨ç½²å™¨ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆäº†è§£å°æ³¢ã€‚Service Weaver åº”ç”¨ç¨‹åºè¢«ç¼–è¯‘æˆå•ä¸ªå¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚é“¾æ¥åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ Service Weaver åº“åŒ…æ‹¬ä¸€ä¸ªç§°ä¸ºweaveletçš„å°ä»£ç†ï¼Œå®ƒæ˜¯åœ¨æ‚¨è°ƒç”¨ weaver.Init æ—¶åˆ›å»ºçš„ã€‚Weavelet çš„ä¸»è¦èŒè´£æ˜¯å¯åŠ¨å’Œç®¡ç†ä¸€ç»„ç»„ä»¶ã€‚
éƒ¨ç½² Service Weaver åº”ç”¨ç¨‹åºæ—¶ï¼Œä¸åªæœ‰ä¸€ä¸ª weaveletã€‚å¦‚æœæœ‰åªæœ‰ä¸€ä¸ªï¼ŒService Weaver åº”ç”¨ç¨‹åºå°±ä¸ä¼šéå¸¸åˆ†æ•£ã€‚ç›¸åï¼Œéƒ¨ç½²äººå‘˜ä¼šå¤šæ¬¡è¿è¡Œæ‚¨çš„äºŒè¿›åˆ¶æ–‡ä»¶â€”â€”åœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒè¿›ç¨‹ä¸­ä»¥å¯åŠ¨å¤šä¸ª weaveletï¼Œè¿™äº› weavelet ååŒå·¥ä½œä»¥æ‰§è¡Œæ‚¨çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºã€‚
æ¯ä¸ª weavelet éƒ½æ‰¿è½½ä¸€ç»„å¯èƒ½ä¸åŒçš„ç»„ä»¶ã€‚å› ä¸ºç»„ä»¶æ˜¯å¤åˆ¶çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªç»„ä»¶å¯èƒ½ç”±å¤šä¸ªweaveletsæ‰˜ç®¡ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªåŒ…å«ç»„ä»¶Aã€Bå’Œçš„åº”ç”¨ç¨‹åºCã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç”±ä¸‰ä¸ªweaveletsç»„æˆçš„ç¤ºä¾‹éƒ¨ç½²ã€‚weavelet 1 æ‰˜ç®¡ç»„ä»¶Aå’ŒBï¼›weavelet 2 æ‰¿è½½ç»„ä»¶Bå’Œ Cï¼Œweavelet 3 æ‰¿è½½ç»„ä»¶Cã€‚
æ‚¨è¿˜ä¼šæ³¨æ„åˆ°æ¯ä¸ªå°æ³¢éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç½‘ç»œåœ°å€ã€‚Weavelets ä½¿ç”¨è¿™äº›åœ°å€æ¥æ‰§è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œå‡è®¾å›¾ä¸­ weavelet 1ä¸Šçš„Aç»„ä»¶æƒ³è¦è°ƒç”¨ç»„ä»¶C ä¸Šçš„æ–¹æ³•ã€‚weavelet 1 å°†è”ç³»åœ°å€ 2.2.2.2 ä¸Šçš„ weavelet 2 æˆ–åœ°å€ 3.3.3.3 ä¸Šçš„ weavelet 3 ä»¥æ‰§è¡Œè¯¥æ–¹æ³•ã€‚
éƒ¨ç½²è€… éƒ¨ç½²è€…é€šè¿‡å¯åŠ¨å’Œç®¡ç†ä¸€ç»„ weavelet æ¥åˆ†å‘ Service Weaver åº”ç”¨ç¨‹åºã€‚ç®¡ç† weavelet æ¶‰åŠä¸ (1) ç»„ä»¶ã€(2) ä¾¦å¬å™¨å’Œ (3) é¥æµ‹ç›¸å…³çš„ä¸‰ä¸ªä¸»è¦èŒè´£ã€‚</description></item><item><title>ä½¿ç”¨dockeræ­å»º tars å¼€å‘ç¯å¢ƒ</title><link>/2022/02/15/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BA-tars-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</link><pubDate>Tue, 15 Feb 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/02/15/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BA-tars-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</guid><description>docker pull tarscloud/framework docker run -d --net=host -e MYSQL_HOST=xxxxx -e MYSQL_ROOT_PASSWORD=xxxxx \ -eREBUILD=false -eINET=eth0 -eSLAVE=false \ -v/data/tars:/data/tars \ -v/etc/localtime:/etc/localtime \ tarscloud/framework # custom docker run -d -eMYSQL_HOST=192.168.1.10 -eMYSQL_USER=root -p 3000:3000 -p 18993:18993 \ -eMYSQL_ROOT_PASSWORD=lbbniu@yang0321 \ -eREBUILD=true -eINET=eth0 -eSLAVE=false \ --name tarsframework \ tarscloud/framework docker run -d -eMYSQL_HOST=10.14.166.155 -eMYSQL_USER=root -p 3000:3000 \ -eMYSQL_ROOT_PASSWORD=123456 \ -eREBUILD=false -eINET=eth0 -eSLAVE=false \ --name tarsframework \ tarscloud/framework docker run -ti --rm tarscloud/framework bash docker pull tarscloud/tars docker run -d --net=host -e MYSQL_HOST=xxxxx -e MYSQL_ROOT_PASSWORD=xxxxx \ -eREBUILD=false -eINET=eth0 -eSLAVE=false \ -v/data/tars:/data/tars \ -v/etc/localtime:/etc/localtime \ tarscloud/tars # custom docker run -d --net=host -e MYSQL_HOST=xxxxx -e MYSQL_ROOT_PASSWORD=xxxxx \ -eREBUILD=false -eINET=eth0 -eSLAVE=false \ -v/data/tars:/data/tars \ -v/etc/localtime:/etc/localtime \ tarscloud/tars docker run -d \ --name=tars-framework \ --net=host \ -e MYSQL_HOST=&amp;quot;10.</description></item><item><title>ç®¡ç†å¤šç‰ˆæœ¬ Go å®‰è£…</title><link>/2021/11/23/%E7%AE%A1%E7%90%86%E5%A4%9A%E7%89%88%E6%9C%AC-go-%E5%AE%89%E8%A3%85/</link><pubDate>Tue, 23 Nov 2021 13:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/23/%E7%AE%A1%E7%90%86%E5%A4%9A%E7%89%88%E6%9C%AC-go-%E5%AE%89%E8%A3%85/</guid><description>ç®¡ç† Go å®‰è£… ç›®å½• å®‰è£…å¤šä¸ª Go ç‰ˆæœ¬ å¸è½½ Go Linux / macOS / FreeBSD è§†çª— æœ¬ä¸»é¢˜ä»‹ç»å¦‚ä½•åœ¨åŒä¸€å°æœºå™¨ä¸Šå®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ Goï¼Œä»¥åŠå¦‚ä½•å¸è½½ Goã€‚
æœ‰å…³å®‰è£…çš„å…¶ä»–å†…å®¹ï¼Œæ‚¨å¯èƒ½å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£ï¼š
ä¸‹è½½å’Œå®‰è£… â€”â€”æœ€ç®€å•çš„å®‰è£…å’Œè¿è¡Œæ–¹å¼ã€‚ ä»æºä»£ç å®‰è£… Goâ€”â€” å¦‚ä½•æ£€æŸ¥æºä»£ç ã€åœ¨æ‚¨è‡ªå·±çš„æœºå™¨ä¸Šæ„å»ºå®ƒä»¬å¹¶è¿è¡Œå®ƒä»¬ã€‚ å®‰è£…å¤šä¸ª Go ç‰ˆæœ¬ æ‚¨å¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¸Šå®‰è£…å¤šä¸ª Go ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨å¤šä¸ª Go ç‰ˆæœ¬ä¸Šæµ‹è¯•æ‚¨çš„ä»£ç ã€‚æœ‰å…³å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å®‰è£…çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œè¯·å‚é˜…ä¸‹è½½é¡µé¢ ã€‚
**æ³¨æ„ï¼š**è¦ä½¿ç”¨æ­¤å¤„æè¿°çš„æ–¹æ³•è¿›è¡Œå®‰è£…ï¼Œæ‚¨éœ€è¦å®‰è£…git ã€‚
è¦å®‰è£…å…¶ä»– Go ç‰ˆæœ¬ï¼Œè¯·è¿è¡Œgo installå‘½ä»¤ ï¼ŒæŒ‡å®šè¦å®‰è£…çš„ç‰ˆæœ¬çš„ä¸‹è½½ä½ç½®ã€‚ä»¥ä¸‹ç¤ºä¾‹è¯´æ˜äº†ç‰ˆæœ¬ 1.10.7ï¼š
# go version &amp;lt; 1.17 $ go get -u golang.org/dl/go1.10.7 # go version &amp;gt;= 1.17 $ go install golang.org/dl/go1.10.7@latest $ go1.10.7 download	è¦ä½¿ç”¨æ–°ä¸‹è½½çš„ç‰ˆæœ¬è¿è¡Œgoå‘½ä»¤ï¼Œè¯·å°†ç‰ˆæœ¬å·é™„åŠ åˆ°goå‘½ä»¤ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
$ go1.10.7 version go version go1.10.7 linux/amd64 å½“æ‚¨å®‰è£…äº†å¤šä¸ªç‰ˆæœ¬æ—¶ï¼Œæ‚¨å¯ä»¥å‘ç°æ¯ä¸ªç‰ˆæœ¬çš„å®‰è£…ä½ç½®ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬çš„GOROOTå€¼ã€‚ä¾‹å¦‚ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š
$ go1.10.7 env GOROOT è¦å¸è½½ä¸‹è½½çš„ç‰ˆæœ¬ï¼Œåªéœ€åˆ é™¤å…¶GOROOTç¯å¢ƒå˜é‡å’Œ goX.</description></item><item><title>å¾®æ˜äº’åŠ¨è´Ÿè´£å‚ä¸é¡¹ç›®</title><link>/2021/11/20/%E5%BE%AE%E6%98%8E%E4%BA%92%E5%8A%A8%E8%B4%9F%E8%B4%A3%E5%8F%82%E4%B8%8E%E9%A1%B9%E7%9B%AE/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/%E5%BE%AE%E6%98%8E%E4%BA%92%E5%8A%A8%E8%B4%9F%E8%B4%A3%E5%8F%82%E4%B8%8E%E9%A1%B9%E7%9B%AE/</guid><description>2014-2016é¡¹ç›® äº‘çƒ­å– app38 è”è” app45 æå®é…·è·‘ app46 htcæ–°æ¸´æœ› app47 æ²ƒå°”ç›åŠ¨æ€è´ºå¡ç”Ÿæˆå™¨ app49 è”ä¿¡ app50 ç¬¬ä¹å± app52/d9ping htcæ–°æ¸´æœ›8 app53 å…­æ¨äº‘å¹³å° app54 æœç‹—æé™ç§‘è€ƒ app55 360å®‰å…¨ç¬¬ä¸€ app57 çº¢æ—— app59 æµ·å°”æ™ºæ…§ç­”é¢˜ app60 å¤šå–œçˆ±æ‰‹æœºç«¯ app61 è”æƒ³thinkpad app62 æ–¯å·´é²æ±½è½¦ app64 è”æƒ³thinkpad è”æƒ³ç¦æ­¢éšåœ°åŠå…¬ app66 è‹æ³Šå°”å¨å…· app70 äºšé©¬é€Š2048 app71 ç‹è€å‰ç–¯ç‹‚2048 app73 è”æƒ³åˆ®åˆ®ä¹ app74 æ·˜æ‰‹æ¸¸ç½‘ç«™æ”¹ç‰ˆï¼ˆYIIæ¡†æ¶ï¼‰ å·´å¸ƒè±†ï¼ˆæ‰‹æœºå’Œpcï¼‰ app75 htc one m8ç”³è¯· app76 é«˜å¾·åœ°å›¾lbså¤§èµ› app77 htc oneé¢„çº¦ï¼ˆæ‰‹æœºå’Œpcï¼‰ app78 åä¸ºMeta7æ‰‹æœº app79 51jobsç»Ÿè®¡æ•°æ® app80 æµ·å°”å£è¢‹ä½“éªŒé¦† app81 ä¸°ç”°ä¸€æœŸ ç›¸ä¿¡è‡ªå·± app83 htcäº”æœˆå¤© app84 æµ·å°”é—®é¢˜æŸ¥è¯¢ app85 ä¸°ç”°äºŒæœŸé¡¹ç›® app86 ç‰¹ç™¾æƒ  app87 ç‰¹ç™¾æƒ å¤–å¸¦å°èŒ app89 ä¸€æ±½å¤§ä¼— app90 æœç‹—æ‰‹æœºæ´»åŠ¨é¡¹ç›® app91 å…¨çƒè´­ å¾®ä¿¡é¡¹ç›®ï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰ app92 thinkphp intelå¤§èµ›é¡¹ç›® app94 è”é€šé‚€è¯·å‡½ app95 ç™¾ä½³æ‰‹æœº app96 IBMä¸‹è½½ä¸­å¿ƒ app97 2015.</description></item><item><title>å¤„ç† Go ä¸­çš„ 'connection reset by peer' é”™è¯¯</title><link>/2022/07/28/connection-reset-by-peer/</link><pubDate>Thu, 28 Jul 2022 17:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/07/28/connection-reset-by-peer/</guid><description>åŸæ–‡é“¾æ¥ï¼šhttps://gosamples.dev/connection-reset-by-peer/ è¿™connection reset by peeræ˜¯åœ¨å¦ä¸€ç«¯ï¼ˆå¯¹ç­‰æ–¹ï¼‰æ„å¤–å…³é—­è¿æ¥æ—¶å‘ç”Ÿçš„TCP/IPé”™è¯¯ã€‚ å½“ä½ ä»ä½ çš„ä¸€ç«¯å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä½†å¦ä¸€ç«¯å´©æºƒå¹¶å¼ºè¡Œå…³é—­ä¸RST æ•°æ®åŒ…çš„è¿æ¥è€Œä¸æ˜¯TCP FIN æ­£å¸¸æƒ…å†µä¸‹ç”¨äºå…³é—­è¿æ¥çš„è¿æ¥æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚åœ¨ Go ä¸­ï¼Œæ‚¨å¯ä»¥connection reset by peeré€šè¿‡æ£€æŸ¥å¯¹ç­‰æ–¹è¿”å›çš„é”™è¯¯æ˜¯å¦ç­‰äº æ¥æ£€æµ‹syscall.ECONNRESET ã€‚
é‡ç°connection reset by peeré”™è¯¯ æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºæ‰§è¡Œä»¥ä¸‹æ“ä½œçš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ¥é‡ç°é”™è¯¯ï¼š
æœåŠ¡å™¨è¯»å–ä¸€ä¸ªå­—èŠ‚ç„¶åå…³é—­è¿æ¥ å®¢æˆ·ç«¯å‘é€è¶…è¿‡ä¸€ä¸ªå­—èŠ‚ å¦‚æœæœåŠ¡å™¨ä½¿ç”¨å¥—æ¥å­—æ¥æ”¶ç¼“å†²åŒºä¸­çš„å‰©ä½™å­—èŠ‚å…³é—­è¿æ¥ï¼Œåˆ™RSTå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚å½“å®¢æˆ·ç«¯è¯•å›¾ä»è¿™æ ·ä¸€ä¸ªå…³é—­çš„è¿æ¥ä¸­è¯»å–æ—¶ï¼Œå®ƒä¼šå¾—åˆ°connection reset by peeré”™è¯¯ã€‚
è¯·å‚é˜…ä»¥ä¸‹ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹æ¨¡æ‹Ÿäº†æ­¤è¡Œä¸ºã€‚
package main import ( &amp;quot;errors&amp;quot; &amp;quot;log&amp;quot; &amp;quot;net&amp;quot; &amp;quot;os&amp;quot; &amp;quot;syscall&amp;quot; &amp;quot;time&amp;quot; ) func server() { listener, err := net.Listen(&amp;quot;tcp&amp;quot;, &amp;quot;:8080&amp;quot;) if err != nil { log.Fatal(err) } defer listener.Close() conn, err := listener.Accept() if err != nil { log.Fatal(&amp;quot;server&amp;quot;, err) os.Exit(1) } data := make([]byte, 1) if _, err := conn.</description></item><item><title>äº‘åŸç”Ÿæ—¶ä»£çš„CoreDNSå­¦ä¹ æŒ‡å— ç¬”è®°</title><link>/2022/07/11/%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E7%9A%84coredns%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97-%E7%AC%94%E8%AE%B0/</link><pubDate>Mon, 11 Jul 2022 15:20:00 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/07/11/%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E7%9A%84coredns%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97-%E7%AC%94%E8%AE%B0/</guid><description>ä¸»æ–‡ä»¶æ ¼å¼çš„è®°å½•ä¸€èˆ¬æ˜¯ä»¥ä¸‹æ ¼å¼ï¼š
[NAME] [TTL] [CLASS] TYPE RDATA NAMEå­—æ®µåŒ…å«èµ„æºè®°å½•é™„åŠ çš„åŸŸåã€‚å®ƒå¯ä»¥æ˜¯ä»¥â€œ.â€ç»“å°¾çš„å®Œå…¨é™å®šåŸŸåï¼ˆFully Qualified Domain Nameï¼ŒFQDNï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ä»¥â€œ.â€ç»“å°¾çš„ç›¸å¯¹åŸŸåã€‚ç›¸å¯¹åŸŸåè¢«è§£é‡Šä¸ºä»¥å½“å‰çš„æºç»“å°¾ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯åŒºåŸŸæ•°æ®æ–‡ä»¶æè¿°çš„åŒºåŸŸçš„åŸŸåã€‚
TTLå­—æ®µæŒ‡å®šäº†èµ„æºè®°å½•çš„ç”Ÿå­˜æ—¶é—´å€¼ï¼Œè¯¥å€¼æ§åˆ¶é€’å½’DNSæœåŠ¡å™¨å¯ä»¥ç¼“å­˜è¯¥è®°å½•çš„æ—¶é—´ã€‚TTLæ˜¯ä¸€ä¸ª32ä½æ•´æ•°è¡¨ç¤ºçš„ç§’æ•°ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨æ‰©å±•å› å­è¡¨ç¤ºTTLï¼Œå¦‚â€œsâ€è¡¨ç¤ºç§’ã€â€œmâ€è¡¨ç¤ºåˆ†é’Ÿã€â€œhâ€è¡¨ç¤ºå°æ—¶ã€â€œdâ€è¡¨ç¤ºå¤©ã€â€œwâ€è¡¨ç¤ºå‘¨ã€‚ä¾‹å¦‚ï¼Œâ€œ1dâ€è¡¨ç¤º1å¤©ï¼Œâ€œ30mâ€è¡¨ç¤º30åˆ†é’Ÿï¼Œâ€œ1h30mâ€è¡¨ç¤º1å°æ—¶30åˆ†é’Ÿã€‚
CLASSå­—æ®µå‡ ä¹æ€»æ˜¯INï¼Œä»£è¡¨äº’è”ç½‘ï¼Œå› æ­¤INä½œä¸ºé»˜è®¤å€¼ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚æ­¤å¤–ç¡®å®è¿˜æœ‰å…¶ä»–çš„å€¼ï¼Œå¦‚ç”¨äºChaosNetçš„CHå’Œç”¨äºHesiodçš„HSã€‚
å®‰è£…etcd rm -rf /tmp/etcd-data.tmp &amp;amp;&amp;amp; mkdir -p /tmp/etcd-data.tmp &amp;amp;&amp;amp; \ docker run \ -p 2379:2379 \ -p 2380:2380 \ --mount type=bind,source=/tmp/etcd-data.tmp,destination=/etcd-data \ --name etcd-gcr-v3.5.4 \ quay.io/coreos/etcd:v3.5.4 \ /usr/local/bin/etcd \ --name s1 \ --data-dir /etcd-data \ --listen-client-urls http://0.0.0.0:2379 \ --advertise-client-urls http://0.0.0.0:2379 \ --listen-peer-urls http://0.0.0.0:2380 \ --initial-advertise-peer-urls http://0.0.0.0:2380 \ --initial-cluster s1=http://0.0.0.0:2380 \ --initial-cluster-token tkn \ --initial-cluster-state new \ --log-level info \ --logger zap \ --log-outputs stderr å…³æ³¨å…¬ä¼—å·è·å¾—æ›´å¤šç²¾å½©æ–‡ç« </description></item><item><title>Google SRE</title><link>/2022/06/21/google-sre/</link><pubDate>Tue, 21 Jun 2022 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2022/06/21/google-sre/</guid><description>ç¬¬4ç«  æœåŠ¡è´¨é‡ç›®æ ‡ æœåŠ¡è´¨é‡æœ¯è¯­ æœåŠ¡è´¨é‡æŒ‡æ ‡ï¼ˆSLIï¼‰â€”â€” indicator æœåŠ¡è´¨é‡ç›®æ ‡ï¼ˆSLOï¼‰â€”â€”Objective æœåŠ¡è´¨é‡åè®®ï¼ˆSLAï¼‰â€”â€”Agreement å•è¯ æŒ‡æ ‡ï¼ˆindicatorï¼‰ æŒä¹…æ€§ï¼ˆdurabilityï¼‰ å¯ç”¨æ€§ï¼ˆavailabilityï¼‰ ç›®æ ‡ï¼ˆObjectiveï¼‰ åè®®ï¼ˆAgreementï¼‰ ç¬¬5ç«  å‡å°‘çäº‹ 4ä¸ªé»„é‡‘æŒ‡æ ‡ å»¶è¿Ÿã€æµé‡ã€é”™è¯¯å’Œé¥±å’Œåº¦ï¼ˆsaturationï¼‰
ç¬¬7ç«  è‡ªåŠ¨åŒ– è‡ªåŠ¨åŒ–å·¥å…·ï¼šPuppetã€Chefã€cfengine
ChubbyæœåŠ¡å™¨
ç¬¬10ç« åŸºäºæ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œæœ‰æ•ˆæŠ¥è­¦ ç›‘æ§ï¼šPormetheusã€Riemannã€Hekaå’ŒBosun
time-series ç¬¬11ç«  on-callè½®å€¼ æœ€ç†æƒ³çš„æ–¹æ³•è®ºæ˜¯è¿™æ ·çš„ï¼šåœ¨æœ‰è¶³å¤Ÿæ•°æ®æ”¯æ’‘çš„æ—¶å€™æŒ‰æ­¥éª¤è§£å†³é—®é¢˜ï¼ŒåŒæ—¶ä¸åœåœ°å®¡è§†å’ŒéªŒè¯ç›®å‰æ‰€æœ‰çš„å‡è®¾ã€‚
æœ€é‡è¦çš„èµ„æºæœ‰ï¼š
â— æ¸…æ™°çš„é—®é¢˜å‡çº§è·¯çº¿ã€‚
â— æ¸…æ™°å®šä¹‰çš„åº”æ€¥äº‹ä»¶å¤„ç†æ­¥éª¤ã€‚
â— æ— æŒ‡è´£ï¼Œå¯¹äº‹ä¸å¯¹äººçš„æ–‡åŒ–æ°›å›´ã€‚
ç¬¬12ç«  æœ‰æ•ˆçš„æ•…éšœæ’æŸ¥æ‰‹æ®µ 1.å¯¹é€šç”¨çš„æ•…éšœæ’æŸ¥è¿‡ç¨‹çš„ç†è§£ï¼ˆä¸ä¾é ä»»ä½•ç‰¹å®šç³»ç»Ÿï¼‰ã€‚
2.å¯¹å‘ç”Ÿæ•…éšœçš„ç³»ç»Ÿçš„è¶³å¤Ÿäº†è§£
è¯»è€…åº”è¯¥å°å¿ƒé¿å…ï¼š â— å…³æ³¨äº†é”™è¯¯çš„ç³»ç»Ÿç°è±¡ï¼Œæˆ–è€…é”™è¯¯åœ°ç†è§£äº†ç³»ç»Ÿç°è±¡çš„å«ä¹‰ã€‚è¿™æ ·ä¼šåœ¨é”™è¯¯çš„æ–¹å‘ä¸Šæµªè´¹æ—¶é—´ã€‚
â— ä¸èƒ½æ­£ç¡®ä¿®æ”¹ç³»ç»Ÿçš„é…ç½®ä¿¡æ¯ã€è¾“å…¥ä¿¡æ¯æˆ–è€…ç³»ç»Ÿè¿è¡Œç¯å¢ƒï¼Œé€ æˆä¸èƒ½å®‰å…¨å’Œæœ‰æ•ˆåœ°æµ‹è¯•å‡è®¾ã€‚
â— å°†é—®é¢˜è¿‡æ—©åœ°å½’ç»“ä¸ºæä¸ºä¸å¯èƒ½çš„å› ç´ ï¼ˆä¾‹å¦‚è®¤ä¸ºæ˜¯å®‡å®™å°„çº¿é€ æˆæ•°æ®å˜åŒ–ï¼Œè™½ç„¶æœ‰å¯èƒ½å‘ç”Ÿï¼Œä½†æ˜¯å¹¶ä¸åº”è¯¥åœ¨è§£å†³é—®é¢˜åˆæœŸåšè¿™ä¸ªå‡è®¾ï¼‰ï¼Œæˆ–è€…å¿µå¿µä¸å¿˜ä¹‹å‰æ›¾ç»å‘ç”Ÿè¿‡çš„ç³»ç»Ÿé—®é¢˜ï¼Œè®¤ä¸ºä¸€æ—¦å‘ç”Ÿè¿‡ä¸€æ¬¡ï¼Œå°±æœ‰å¯èƒ½å†æ¬¡å‘ç”Ÿã€‚
â— è¯•å›¾è§£å†³ä¸å½“å‰ç³»ç»Ÿé—®é¢˜ç›¸å…³çš„ä¸€äº›é—®é¢˜ï¼Œå´æ²¡æœ‰è®¤è¯†åˆ°è¿™äº›å…¶å®åªæ˜¯å·§åˆï¼Œæˆ–è€…è¿™äº›é—®é¢˜å…¶å®æ˜¯ç”±äºå½“å‰ç³»ç»Ÿçš„é—®é¢˜é€ æˆçš„ã€‚ï¼ˆæ¯”å¦‚å‘ç°æ•°æ®åº“å‹åŠ›å¤§çš„æƒ…å†µä¸‹ï¼Œç¯å¢ƒæ¸©åº¦ä¹Ÿæœ‰æ‰€ä¸Šå‡ï¼Œäºæ˜¯è¯•å›¾è§£å†³ç¯å¢ƒæ¸©åº¦é—®é¢˜ã€‚ï¼‰
Dapper æä¾›äº†éå¸¸æœ‰ç”¨çš„äº†è§£åˆ†å¸ƒå¼ç³»ç»Ÿå·¥ä½œæƒ…å†µçš„ä¸€ç§æ–¹å¼
å•è¯ ç›‘æµ‹æŒ‡æ ‡ï¼ˆtelemetryï¼‰
å®šä½ï¼ˆtriageï¼‰
ç›¸å…³æ€§ï¼ˆcorrelationï¼‰
å› æœå…³ç³»ï¼ˆcausationï¼‰
é—®é¢˜åˆ†è§£ï¼ˆDivide &amp;amp; Conquerï¼‰
å¯¹åˆ†æ³•ï¼ˆbisectionï¼‰
ç¬¬14ç«  ç´§æ€¥äº‹æ•…ç®¡ç† ä¸€æ¬¡æµç¨‹ç®¡ç†è‰¯å¥½çš„äº‹æ•… ç¬¬17ç«  æµ‹è¯•å¯é æ€§ ä¼ ç»Ÿæµ‹è¯• å•å…ƒæµ‹è¯•ï¼ˆunit testï¼‰ é›†æˆæµ‹è¯•ï¼ˆintegration testï¼‰ ä¾èµ–æ³¨å…¥ï¼ˆdependency injectionï¼‰ ç³»ç»Ÿæµ‹è¯•ï¼ˆsystem testï¼‰ å†’çƒŸæµ‹è¯•ï¼ˆsmoke testï¼‰ï¼šå†’çƒŸæµ‹è¯•æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºç†æ€§æµ‹è¯• æ€§èƒ½æµ‹è¯•ï¼ˆperformance testï¼‰ å›å½’æµ‹è¯•ï¼ˆregression testï¼‰ ç”Ÿäº§æµ‹è¯• å˜æ›´å‘å¸ƒä¸æµ‹è¯• é…ç½®æµ‹è¯• é‡‘ä¸é›€æµ‹è¯• ç¬¬18ç«  SRE éƒ¨é—¨ä¸­çš„è½¯ä»¶å·¥ç¨‹å®è·µ Auxon æ¡ˆä¾‹ åŸºäºæ„å›¾çš„å®¹é‡è§„åˆ’ 1.</description></item><item><title>Hugo + Github Actions å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²</title><link>/2021/11/20/hugo--github-actions-%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/</link><pubDate>Sat, 20 Nov 2021 20:33:21 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/hugo--github-actions-%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/</guid><description>å‚è€ƒè¿æ¥ Hugo + Github Actions å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½² GitHub Actions å®æˆ˜ - ç”¨ Hugo è‡ªåŠ¨æ„å»º æ­å»º GitHub Pages HUGO + Github + Github ActionæŒç»­é›†æˆéƒ¨ç½²ä¸ªäººåšå®¢ ä½¿ç”¨ Markdown åœ¨ hugo å¸–å­å†…å®¹ä¸­åˆ›å»ºå¸¦æœ‰ &amp;rsquo;target=&amp;quot;_blank&amp;quot;&amp;rsquo; çš„é“¾æ¥å—ï¼Ÿ æ‚¨éœ€è¦åœ¨/layouts/_default/_markup/ calledå¤„åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶render-link.html
åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥å°†å…¶è‡ªå®šä¹‰ä¸ºï¼š
&amp;lt;a href=&amp;quot;{{ .Destination | safeURL }}&amp;quot;{{ with .Title}} title=&amp;quot;{{ . }}&amp;quot;{{ end }}{{ if strings.HasPrefix .Destination &amp;quot;http&amp;quot; }} target=&amp;quot;_blank&amp;quot; rel=&amp;quot;noopener&amp;quot;{{ end }}&amp;gt;{{ .Text | safeHTML }}&amp;lt;/a&amp;gt; ä»¥ä¸‹æ˜¯ä¼šå‘ç”Ÿçš„æƒ…å†µï¼š
- [link1](../something/ title=&amp;quot;title&amp;quot;) =&amp;gt; &amp;lt;a href=&amp;quot;../something/&amp;quot; title=&amp;quot;title&amp;quot;&amp;gt;link1&amp;lt;/a&amp;gt; - [link2](https://example.com) =&amp;gt; &amp;lt;a href=&amp;quot;https://example.com&amp;quot;&amp;gt;link2&amp;lt;/a&amp;gt; å®ƒåªä¼šå°†å…¶æ·»åŠ åˆ°å¸¦æœ‰â€œhttpâ€å’Œâ€œhttpsâ€çš„ URLã€‚
æ¸²æŸ“æŒ‚é’©çš„æ–‡æ¡£å¯åœ¨æ­¤å¤„è·å¾—ï¼šhttps://gohugo.io/templates/render-hooks/ å…³æ³¨å…¬ä¼—å·è·å¾—æ›´å¤šç²¾å½©æ–‡ç« </description></item><item><title>Dockerä¿®æ”¹é»˜è®¤ç½‘æ®µ</title><link>/2021/11/20/docker%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%BD%91%E6%AE%B5/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/docker%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%BD%91%E6%AE%B5/</guid><description>cat /etc/docker/daemon.json { &amp;quot;registry-mirrors&amp;quot;: [ &amp;quot;https://mirror.ccs.tencentyun.com&amp;quot; ], &amp;quot;bip&amp;quot;:&amp;quot;192.168.100.1/24&amp;quot; } å…³æ³¨å…¬ä¼—å·è·å¾—æ›´å¤šç²¾å½©æ–‡ç« </description></item><item><title>fabricä¸€äº›ç®€å•ç”¨æ³•æ€»ç»“</title><link>/2021/11/20/fabric%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/fabric%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/</guid><description>1.æ”¯æŒä¸­æ–‡
#!/usr/bin/python env # -*- coding: utf-8 -*- 2.æ”¯æŒé¢œè‰²
from fabric.colors import * print(red(&amp;quot;çº¢è‰²&amp;quot;) + green(&amp;quot;ç»¿è‰²&amp;quot;ï¼Œbold=False) + blue(&amp;quot;è“è‰²&amp;quot;,bold=True) + white(&amp;quot;ç™½è‰²&amp;quot;) + yellow(&amp;quot;é»„è‰²&amp;quot;) + cyan(&amp;quot;è“ç»¿è‰²&amp;quot;) + magenta(&amp;quot;å“çº¢è‰²&amp;quot;)) 3.è®¾ç½®ä¸»æœºç»„åŠè´¦å·å¯†ç 
ä¸»æœºå¯†ç ä¸åŒæ—¶ï¼š
env.hosts = ['tomcat@192.168.244.128','tomcat@192.168.244.129'] env.passwords = {'tomcat@192.168.244.128:22':'111111','tomcat@192.168.244.129:22':'111111'} ä¸»æœºå¯†ç ç›¸åŒæ—¶:
env.hosts=[ 'tomcat@192.168.244.128:22', 'tomcat@192.168.244.129:22', ] env.password = '1111' ä½¿ç”¨ssh keyfile:
env.key_filename = ['/opt/fab/server_key'] env.user = 'tomcat' env.password = '111111' env.port = '2862' 4.è¿è¡Œshellå‘½ä»¤
åœ¨æœ¬åœ°è¿è¡Œå‘½ä»¤:
local('pwd') local('set -m ; /etc/init.d/tomcat restart') # å¦‚æœæ˜¯è„šæœ¬ï¼Œè¦åŠ set -m æ”¯æŒåå°æ‰§è¡Œå¹¶è¿”å›çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ¥é”™ åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œå‘½ä»¤:
run('uname -a') 5.åˆ‡æ¢ç›®å½•æ‰§è¡Œ
with cd('/opt/tomcat') run('set -m ; .</description></item><item><title>nginx luaç›´æ¥é˜¶æ®µ</title><link>/2021/11/20/nginx-lua%E7%9B%B4%E6%8E%A5%E9%98%B6%E6%AE%B5/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/nginx-lua%E7%9B%B4%E6%8E%A5%E9%98%B6%E6%AE%B5/</guid><description>å¯¹åˆšæ¥è§¦Ngx_luaçš„è¯»è€…æ¥è¯´ï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸‹é¢ä¸¤ä¸ªå›°æƒ‘ã€‚
1ã€Luaåœ¨Nginxçš„å“ªäº›é˜¶æ®µå¯ä»¥æ‰§è¡Œä»£ç ï¼Ÿ 2ã€Luaåœ¨Nginxçš„æ¯ä¸ªé˜¶æ®µå¯ä»¥æ‰§è¡Œå“ªäº›æ“ä½œï¼Ÿ
åªæœ‰ç†è§£äº†è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ‰èƒ½åœ¨ä¸šåŠ¡ä¸­å·§å¦™åœ°åˆ©ç”¨Ngx_Luaæ¥å®Œæˆå„é¡¹éœ€æ±‚ã€‚
Nginxçš„11ä¸ªæ‰§è¡Œé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰è‡ªå·±èƒ½å¤Ÿæ‰§è¡Œçš„æŒ‡ä»¤ï¼Œå¹¶å¯ä»¥å®ç°ä¸åŒçš„åŠŸèƒ½ã€‚Ngx_Luaçš„åŠŸèƒ½å¤§éƒ¨åˆ†æ˜¯åŸºäºNginxè¿™11ä¸ªæ‰§è¡Œé˜¶æ®µå¼€å‘å’Œé…ç½®çš„ï¼ŒLuaä»£ç åœ¨è¿™äº›æŒ‡ä»¤å—ä¸­æ‰§è¡Œï¼Œå¹¶ä¾èµ–äºå®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚æœ¬ç« å°†å¯¹Ngx_Luaçš„æ‰§è¡Œé˜¶æ®µè¿›è¡Œä¸€ä¸€è®²è§£ã€‚
ä¸€ã€ init_by_lua_block init_by_lua_blockæ˜¯init_by_luaçš„æ›¿ä»£ç‰ˆæœ¬ï¼Œåœ¨OpenResty 1.9.3.1æˆ–Lua-Nginx-Modulev 0.9.17ä¹‹å‰ä½¿ç”¨çš„éƒ½æ˜¯init_by_luaã€‚init_by_lua_blockæ¯”init_by_luaæ›´çµæ´»ï¼Œæ‰€ä»¥å»ºè®®ä¼˜å…ˆé€‰ç”¨init_by_lua_blockã€‚ æœ¬ç« ä¸­çš„æ‰§è¡Œé˜¶æ®µéƒ½é‡‡ç”¨*_blockæ ¼å¼çš„æŒ‡ä»¤ï¼Œåç»­ä¸å†è¯´æ˜ã€‚
1.1ã€€é˜¶æ®µè¯´æ˜ è¯­æ³•ï¼šinit_by_lua_block {lua-script-str} é…ç½®ç¯å¢ƒï¼šhttp é˜¶æ®µï¼šloading-config å«ä¹‰ï¼šå½“Nginxçš„masterè¿›ç¨‹åŠ è½½Nginxé…ç½®æ–‡ä»¶ï¼ˆåŠ è½½æˆ–é‡å¯Nginxè¿›ç¨‹ï¼‰æ—¶ï¼Œä¼šåœ¨å…¨å±€çš„Lua VMï¼ˆVirtual Machineï¼Œè™šæ‹Ÿæœºï¼‰å±‚ä¸Šè¿è¡Œ æŒ‡å®šçš„ä»£ç ï¼Œæ¯æ¬¡å½“Nginxè·å¾—HUPï¼ˆå³Hangupï¼‰é‡è½½ä¿¡å·åŠ è½½è¿›ç¨‹æ—¶ï¼Œä»£ç éƒ½ä¼šè¢«é‡æ–°æ‰§è¡Œã€‚
1.2ã€€åˆå§‹åŒ–é…ç½® åœ¨loading-configé˜¶æ®µä¸€èˆ¬ä¼šæ‰§è¡Œå¦‚ä¸‹æ“ä½œã€‚ 1ï¼åˆå§‹åŒ–Luaå…¨å±€å˜é‡ï¼Œç‰¹åˆ«é€‚åˆç”¨æ¥å¤„ç†åœ¨å¯åŠ¨masterè¿›ç¨‹æ—¶å°±è¦æ±‚å­˜åœ¨çš„æ•°æ®ï¼Œå¯¹CPUæ¶ˆè€—è¾ƒå¤šçš„åŠŸèƒ½ä¹Ÿå¯ä»¥åœ¨æ­¤å¤„å¤„ç†ã€‚ 2ï¼é¢„åŠ è½½æ¨¡å—ã€‚ 3ï¼åˆå§‹åŒ–lua_shared_dictå…±äº«å†…å­˜çš„æ•°æ®ï¼ˆå…³äºå…±äº«å†…å­˜è¯¦è§ç¬¬10ç« ï¼‰ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š
user webuser webuser; worker_processes 1; worker_rlimit_nofile 10240; events { use epoll; worker_connections 10240; } http { include mime.types; default_type application/octet-stream; log_format main '$remote_addr-$remote_user[$time_local] &amp;quot;$request&amp;quot; ' '$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; ' '&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot; &amp;quot;$request_time&amp;quot; &amp;quot;$upstream_addr $upstream_status $upstream_response_time&amp;quot; &amp;quot;upstream_time_sum:$upstream_time_sum&amp;quot; &amp;quot;jk_uri:$jk_uri&amp;quot;'; access_log logs/access.log main; sendfile on; keepalive_timeout 65; lua_package_path &amp;quot;/usr/local/nginx_1.12.2/conf/lua_modules/?.lua;;&amp;quot;; lua_package_cpath &amp;quot;/usr/local/nginx_1.</description></item><item><title>OpenVpnæ­å»º</title><link>/2021/11/20/openvpn%E6%90%AD%E5%BB%BA/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/openvpn%E6%90%AD%E5%BB%BA/</guid><description>åˆå§‹åŒ– # è¯ä¹¦å¯†ç è§æœåŠ¡å™¨ mm.md # åˆ›å»ºç›®å½• mkdir -p /data/openvpn/conf # åˆå§‹åŒ– openvpn é…ç½® docker run -v /data/openvpn:/etc/openvpn --rm kylemanna/openvpn ovpn_genconfig -u udp://vpn.lbbniu.com # åˆå§‹åŒ–è¯ä¹¦ æ ¹æ®æç¤ºæ•°æ®è¯ä¹¦å¯†ç å’Œç»„ç»‡åç§° docker run -v /data/openvpn:/etc/openvpn --rm -ti kylemanna/openvpn ovpn_initpki # å¢åŠ ç”¨æˆ· docker run -v /data/openvpn:/etc/openvpn --rm -ti kylemanna/openvpn easyrsa build-client-full lbbniu nopass # å¯¼å‡ºç”¨æˆ·é…ç½®æ–‡ä»¶ docker run -v /data/openvpn:/etc/openvpn --rm -ti kylemanna/openvpn ovpn_getclient lbbniu &amp;gt; /data/openvpn/conf/lbbniu.ovpn # å¯åŠ¨æœåŠ¡ docker run --name openvpn -v /data/openvpn:/etc/openvpn -d -p 1194:1194/udp --cap-add=NET_ADMIN kylemanna/openvpn æ·»åŠ ç”¨æˆ·è„šæœ¬ #!/bin/bash # openvpn_useradd.</description></item><item><title>é™æ€åšå®¢å·¥å…·</title><link>/2021/11/20/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E5%B7%A5%E5%85%B7/</link><pubDate>Sat, 20 Nov 2021 17:18:16 +0800</pubDate><author>lbbniu@gmail.com (lbbniu)</author><guid>/2021/11/20/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E5%B7%A5%E5%85%B7/</guid><description> ruby ç¼–å†™çš„ Jekyll [GitHub Pagesæ”¯æŒ]
Node.js ç¼–å†™çš„ Hexo
Vue.js ç¼–å†™çš„ vuepress
Go ç¼–å†™çš„ Hugo
Python ç¼–å†™çš„ Pelican
ä»¥åŠæ›´äººæ€§åŒ–çš„ Gridea
GitHub Pages æ­å»ºæ•™ç¨‹ hugoç›¸å…³åšå®¢</description></item></channel></rss>